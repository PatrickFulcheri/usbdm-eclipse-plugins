<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root SYSTEM "Menu.dtd" >
<!-- osc0_div.xml -->
<!--
Devices using this peripheral: 
      MK02F12810
      MK22F12810
      MK22F25612
      MK22F51212
      MK65F18
      MK66F18
      MKV30F12810
      MKV31F12810
      MKV31F25612
      MKV31F51212
      MKV40F15
      MKV43F15
      MKV44F15
      MKV45F15
      MKV46F15
-->
<root xmlns:xi="http://www.w3.org/2001/XInclude">
   <page name="_instance" description="Oscillator">

      <binaryOption name="osc_cr_erclken"
         description="External Reference Enable"
         toolTip="Enables and makes available the clock as OSCERCLK peripheral clock source\n
         The oscillator will also be enabled if used by MCG">
         <choice value="0" name="Disabled" />
         <choice value="1" name="Enabled" isDefault="true" />
      </binaryOption>
      
      <intOption name="oscclk_clock"
         units="Hz"
         description="Frequency of OSC Clock or Crystal [OSCCLK]"
         toolTip="Frequency of external crystal or clock on XTAL/EXTAL"
         value="8000000" />

      <!-- intOption name="oscRange"
         description="Frequency of OSC Clock or Crystal [OSCCLK]"
         toolTip="Frequency of external crystal or clock on XTAL/EXTAL"
         value="0" / -->

      <choiceOption name="range"
         constant="true"
         description="Frequency Range Select"
         toolTip="Selects the frequency range for the crystal oscillator\n
                  May affect the choice of divider for FLL input clock">
         <choice value="0" name="Low range" />
         <choice value="1" name="High range" />
         <choice value="2" name="Very High range" />
      </choiceOption>

      <binaryOption name="erefs0"
         description="External Reference Select" 
         toolTip="Determines whether a clock or crystal is used for the external reference clock" >
         <choice value="0" name="External clock" />
         <choice value="1" name="Oscillator" isDefault="true" />
      </binaryOption>

      <binaryOption name="hgo0"
         description="Oscillator Gain" 
         toolTip="Controls the crystal oscillator mode of operation">
         <choice value="0" name="Low power" isDefault="true"/>
         <choice value="1" name="High gain" />
      </binaryOption>
      
      <choiceOption name="osc_cr_scp"
         description="Oscillator load capacitance"
         toolTip="Configures the oscillator load capacitance" >
         <choice value="0"  name="0 pF" />
         <choice value="8"  name="2 pF" />
         <choice value="4"  name="4 pF" />
         <choice value="12" name="6 pF" />
         <choice value="2"  name="8 pF" isDefault="true" />
         <choice value="10" name="10 pF" />
         <choice value="6"  name="12 pF" />
         <choice value="14" name="14 pF" />
         <choice value="1"  name="16 pF" />
         <choice value="9"  name="18 pF" />
         <choice value="5"  name="20 pF" />
         <choice value="13" name="22 pF" />
         <choice value="3"  name="24 pF" />
         <choice value="11" name="26 pF" />
         <choice value="7"  name="28 pF" />
         <choice value="15" name="30 pF" />
      </choiceOption>

      <binaryOption name="osc_cr_erefsten"
         description="External Reference Stop Enable"
         toolTip="Determines if external reference clock is enabled in Stop mode" >
         <choice value="0" name="Disabled in Stop mode" />
         <choice value="1" name="Enabled in Stop mode" />
      </binaryOption>
      
         <intOption name="system_oscerclk_undiv_clock"  key="/OSC0/system_oscerclk_undiv_clock"
            units="Hz"
            description="Oscillator clock to some peripherals [OSCERCLK_UNDIV]"
            toolTip="Generated from OSCCLK without division"
            value="8000000"  
            constant="true" />
   
         <choiceOption name="osc_div_erps"   key="/OSC0/osc_div_erps"
            description="ERCLK prescaler"
            toolTip="Divides down the ERCLK output" >
            <choice value="0"  name="Divide by 1" isDefault="true" />
            <choice value="1"  name="Divide by 2" />
            <choice value="2"  name="Divide by 4" />
            <choice value="3"  name="Divide by 8" />
         </choiceOption>
	 
      <intOption name="system_oscerclk_clock"
            units="Hz"
            description="Oscillator clock to peripherals [OSCERCLK]"
            toolTip="Generated from OSCCLK"
            value="8000000"  
            constant="true" />

      <intOption name="osc32kclk_clock"
            units="Hz"
            description="Oscillator low range 32K clock [OSC32KCLK]"
            toolTip="Generated from OSCCLK. May be used as ERCLK32K"
            value="8000000"  
            constant="true" />
      <pins />
   </page>

   <validate
      class="net.sourceforge.usbdm.deviceEditor.validators.OscValidate">
   </validate>

   <projectActionList id = "osc_files" >
      <copy source="Project_Headers/osc.h"  target="Project_Headers/osc.h"  replace="true"  derived="true" />
   </projectActionList>
         
   <template>
      \t//! Frequency of OSC Clock or Crystal\n
      \tstatic constexpr uint32_t oscclk_clock = $(oscclk_clock)UL;\n\n
      
      \t//! Frequency of 32K OSC Clock or Crystal (if applicable)
      \tstatic constexpr uint32_t osc32kclk_clock = $(osc32kclk_clock)UL;\n\n
      
      \t//! Oscillator control register\n
      \tstatic constexpr uint32_t osc_cr =
      \t   OSC_CR_ERCLKEN($(osc_cr_erclken)) |
      \t   OSC_CR_EREFSTEN($(osc_cr_erefsten)) |
      \t   OSC_CR_SCP($(osc_cr_scp));\n\n      

      \t//! OSC Clock divider register\n
      \tstatic constexpr uint32_t osc_div =
      \t   OSC_DIV_ERPS($(osc_div_erps));   
   </template>
</root>

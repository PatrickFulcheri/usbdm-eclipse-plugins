<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root SYSTEM "Menu.dtd" >
<!-- Mgc.xml -->

<root xmlns:xi="http://www.w3.org/2001/XInclude">
   <menu name="_instance" description="Clock Configuration">
      <intOption name="oscclk_clock"
         description="Frequency of Main External Clock or Crystal (Hz)"
         toolTip="Frequency of external crystal or clock on XTAL/EXTAL\n See MCG_C2_EREFS0 for XTAL/Clock selection"
         value="8000000" min="0" max="50000000" />

      <intOption name="rtcclk_clock"
         description="Frequency of RTC External Clock or Crystal (Hz)"
         toolTip="Frequency of external crystal or clock on XTAL32/EXTAL32 [Typically 32768 Hz]"
         value="32768" min="30000" max="40000" step="1" />

      <intOption name="irc48m_clock" description="Frequency of Internal 48MHz Clock"
         toolTip="48 MHz Internal Oscillator [Trimmed against USB bus]"
         value="48000000" constant="true" />

      <intOption name="system_low_power_clock"
         description="Frequency of Internal Low Power Oscillator Clock (Hz)"
         toolTip="Dependent on device. [Typically ~1kHz]" value="1000"
         constant="true" />

      <intOption name="system_erc_clock" description="External Reference Clock (Hz)"
         toolTip="Derived from the OSCCLK0 (external crystal or clock source on XTAL/EXTAL), RTC_CLOCK(XTAL32/EXTAL32) or IRC48M(Internal 48MHz)"
         value="12000000" constant="true" />

      <intOption name="system_slow_irc_clock"
         description="Frequency of Slow Internal Reference Clock (Hz)"
         toolTip="Dependent on device and clock Trim. [Typically ~32kHz]"
         value="1000" constant="true" />

      <intOption name="system_fast_irc_clock"
         description="Frequency of Fast Internal Reference Clock (Hz)"
         toolTip="Dependent on device and clock Trim. [Typically ~4MHz]"
         value="4000000" constant="true" />

      <intOption name="system_usb_clkin_clock" description="Frequency of External USB Clock (Hz)"
         toolTip="Externally provided clock for USB on USB_CLKIN" value="48000000"
         constant="true" />

      <choiceOption name="clock_mode" description="Clock Mode"
         toolTip="
            FLL Engaged Internal(FEI)\n
            In FEI mode, MCGOUT is derived from the FLL clock (DCOCLK) that is controlled by the 32 kHz Internal Reference Clock (IRC).\n
            The FLL loop will lock the DCO frequency to the FLL factor, as selected by the C4[DRST_DRS] and C4[DMX32] bits, times the\n
            internal reference frequency.\n
            \n
            FLL Engaged External(FEE)\n
            In FEE mode, MCGOUT is derived from the FLL clock (DCOCLK) that is controlled by the external reference clock. The FLL loop\n
            will lock the DCO frequency to the FLL factor, as selected by C4[DRST_DRS] and C4[DMX32] bits, times the external reference\n
            frequency, as specified by the C1[FRDIV] and C2[RANGE].\n
            \n
            FLL Bypassed Internal(FBI)\n
            In FBI mode, the MCGOUT clock is derived either from the slow (32 kHz IRC) or fast (2 MHz IRC) internal reference clock,\n
            as selected by the C2[IRCS] bit. The FLL is operational but its output is not used. This mode is useful to allow the FLL\n
            to acquire its target frequency while the MCGOUT clock is driven from the C2[IRCS] selected internal reference clock. The\n
            FLL clock (DCOCLK) is controlled by the slow internal reference clock, and the DCO clock frequency locks to a multiplication\n
            factor, as selected by the C4[DRST_DRS] and C4[DMX32] bits, times the internal reference frequency.\n
            \n
            FLL Bypassed External(FBE)\n
            In FBE mode, the MCGOUT clock is derived from the external reference clock. The FLL is operational but its output is not\n
            used. This mode is useful to allow the FLL to acquire its target frequency while the MCGOUT clock is driven from the\n
            external reference clock. The FLL clock (DCOCLK) is controlled by the external reference clock, and the DCO clock frequency\n
            locks to a multiplication factor, as selected by the C4[DRST_DRS] and C4[DMX32] bits, times the divided external reference\n
            frequency.\n
            \n
            PLL Engaged External(PEE)\n
            In PEE mode, the MCGOUT is derived from the PLL clock, which is controlled by the external reference clock. The PLL clock\n
            frequency locks to a multiplication factor, as specified by C6[VDIV0], times the external reference frequency, as specified\n
            by C5[PRDIV0].\n
            \n
            PLL Bypassed External(PBE)\n
            In PBE mode, MCGOUT is derived from the OSCSEL external reference clock; the PLL is operational, but its output clock is\n
            not used. This mode is useful to allow the PLL to acquire its target frequency while MCGOUT is driven from the external\n
            reference clock. The PLL clock frequency locks to a multiplication factor, as specified by its [VDIV0], times the external\n
            reference frequency, as specified by its [PRDIV0].\n
            \n
            Bypassed Low Power Internal (BLPI/FBILP)\n
            In BLPI mode, MCGOUT is derived from the internal reference clock. The FLL is disabled and PLL is disabled even if the\n
            C5[PLLCLKEN] is set to 1.\n
            \n
            Bypassed Low Power External (BLPE/FBELP)\n
            In BLPE mode, MCGOUT is derived from the external reference clock. The FLL is disabled and PLL is disabled even if the\n
            C5[PLLCLKEN] is set to 1.">
         <choice name="No setup (Reset default)" value="0" />
         <choice name="FLL Engaged Internal (FEI)" value="1" />
         <choice name="FLL Engaged External (FEE)" value="2" />
         <choice name="FLL bypassed internal (FBI)" value="3" />
         <choice name="Bypassed low power internal (BLPI)" value="4" />
         <choice name="FLL bypassed external (FBE)" value="5" />
         <choice name="Bypassed low power external (BLPE)" value="6" />
         <choice name="PLL Bypassed External (PBE)" value="7" />
         <choice name="PLL Engaged External (PEE)" value="8" />
      </choiceOption>
   
      <intOption name="pllTargetFrequency"
         description="PLL Output clock frequency (Hz)"
         toolTip="Used for MCGPLLCLK system clock\nUsed for main MCGOUTCLK system clock if PEE mode is selected"
         value="120000000" constant="true" />

      <intOption name="fllTargetFrequency"
         description="FLL Output clock frequency (Hz)"
         toolTip="Used for MCGFLLCLK system clock\nUsed for main MCGOUTCLK system clock if FEI or FEE mode is selected"
         value="96000000" constant="true" />

      <intOption name="system_mcgout_clock"
         description="System MCGOUT Clock (Hz)"
         toolTip="MCG Main clock output\nDerived from slow IRC, fast IRC, ERC, FLL or PLL"
         value="120000000" constant="true" />
         
      <intOption name="system_mcgir_clock"
         description="System MCGIR Clock (Hz)"
         toolTip="MCG Internal Reference Clock\nDerived from slow IRC or fast IRC"
         value="32768" constant="true" />

      <intOption name="system_core_clock"
         description="System Core Clock (Hz)"
         toolTip="Clocks the ARM Cortex-M4 core and bus masters\nDerived from MCGOUT Clock after division by OUTDIV1"
         value="120000000" constant="true" />

      <intOption name="system_bus_clock"
         description="System Bus Clock (Hz)"
         toolTip="Clocks the bus slaves and peripherals\n
            Derived from MCGOUT Clock after division by OUTDIV2\n
            Must be &lt;= Core Clock frequency and an integer divisor"
         value="60000000" constant="true" />

      <intOption name="system_flexbus_clock"
         description="System Flexbus Clock (Hz)"
         toolTip="Clocks the flexbus interface\n
            Derived from MCGOUT clock after division by OUTDIV3.\n
            Must be &lt;= Bus Clock frequency"
         value="60000000" constant="true" />

      <intOption name="system_flash_clock"
         description="System Flash Clock (Hz)"
         toolTip="Clocks the flash memory
            Derived from MCGOUT clock after division by OUTDIV4.\n
            Must be an integer divisor of the Core Clock.\n
            Must be &lt;= Bus Clock frequency."
         value="24000000" constant="true" />

      <intOption name="sim_clkdiv1_outdiv1"
         description="Core &amp; System Clock Divider (OUTDIV1) - Divide by [1-16]"
         toolTip="Clocks the ARM Cortex-M4 core and bus masters [SIM_CLKDIV1_OUTDIV1]\n
            MCGOUTCLK clock is source. Default /1"
         value="0" constant="true" />

      <intOption name="sim_clkdiv1_outdiv2"
         description="Bus Clock Divider (OUTDIV2) - Divide by [1-16]"
         toolTip="Clocks the bus slaves and peripheral [SIM_CLKDIV1_OUTDIV2]\n
            MCGOUTCLK clock is source. Default /2"
         value="1" constant="true" />

      <intOption name="sim_clkdiv1_outdiv3"
         description="Flexbus Clock Divider (OUTDIV3) - Divide by [1-16]"
         toolTip="Clocks the flexbus interface [SIM_CLKDIV1_OUTDIV3]\n
            MCGOUTCLK clock is source. Default /2"
         value="1" constant="true" />

      <intOption name="sim_clkdiv1_outdiv4"
         description="Flash Clock Divider (OUTDIV4) - Divide by [1-16]"
         toolTip="Clocks the flash memory [SIM_CLKDIV1_OUTDIV4]\n
            MCGOUTCLK clock is source. Default /4"
         value="4" constant="true" />
         
      <menu name="MCG_C1" description="MCG Control Register 1">
         <choiceOption name="mcg_c1_clks" description="MCGOUTCLK Clock Source Select (CLKS) [0-2]"
            toolTip="Selects the clock source for MCGOUTCLK [MCG_C1_CLKS]\n
               This option is determined by the Clock Mode selection">
            <choice value="0" name="Output of FLL or PLL is selected" />
            <choice value="1" name="Internal reference clock is selected" />
            <choice value="2" name="External reference clock is selected" />
            <choice value="0" name="Default" />
         </choiceOption>
         
         <choiceOption name="mcg_c1_frdiv" description="FLL External Reference Divider (FRDIV)"
            toolTip="Selects the amount to divide down the external reference clock for the FLL. [MCG_C1_FRDIV]\n
               The resulting frequency must be in the range 31.25 kHz to 39.0625 kHz\n
               Division factor depends on Clock Range [MGC_C2_RANGE0]\n
               This option is determined by the Clock Mode and FLL input clock">
            <choice value="0" name="if RANGE0 = 0 divide by 1, else 32" />
            <choice value="1" name="if RANGE0 = 0 divide by 2, else 64" />
            <choice value="2" name="if RANGE0 = 0 divide by 4, else 128" />
            <choice value="3" name="if RANGE0 = 0 divide by 8, else 256" />
            <choice value="4" name="if RANGE0 = 0 divide by 16, else 512" />
            <choice value="5" name="if RANGE0 = 0 divide by 32, else 1024" />
            <choice value="6" name="if RANGE0 = 0 divide by 64, else 1280" />
            <choice value="7" name="if RANGE0 = 0 divide by 128, else 1536" />
            <choice value="0" name="Default" />
         </choiceOption>
         
         <binaryOption name="mcg_c1_irefs" description="Internal Reference Select (IREFS)"
            toolTip="Selects the reference clock source for the FLL [MCG_C1_IREFS]\n
               This option is determined by the Clock Mode selection">
            <choice value="0" name="External Reference Clock" />
            <choice value="1" name="Slow Internal Clock" />
         </binaryOption>
         
         <binaryOption name="IRCLKEN" description="Internal Reference Clock Enable"
            toolTip="Enables the internal reference clock for use as MCGIRCLK">
            <choice value="0" name="Inactive" />
            <choice value="1" name="Active" />
         </binaryOption>
      
         <binaryOption name="IREFSTEN" description=" Internal Reference Stop Enable"
            toolTip="Determines if IRS is enabled in Stop mode">
            <choice value="0" name="IR disabled in STOP" />
            <choice value="1" name="IR enabled in STOP" />
         </binaryOption>
      
      </menu>
   </menu>
   <validate
      class="net.sourceforge.usbdm.annotationEditor.validators.ClockValidate_MKxx">
      <param type="int" value="120000000" /> <!-- Core -->
      <param type="int" value="60000000" />  <!-- Bus -->
      <param type="int" value="28000000" />  <!-- Flash -->
      <param type="int" value="60000000" />  <!-- Flexbus -->
   </validate>
   <template>
      \t//! Clock Mode\n
      \tstatic constexpr uint32_t CLOCK_MODE = $(clock_mode);\n\n
   </template>
</root>

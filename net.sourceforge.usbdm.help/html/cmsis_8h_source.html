<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>USBDM: Project_Headers/cmsis.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">USBDM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_35b2bb0456da6899b329243c75a0792d.html">Project_Headers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cmsis.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cmsis_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * @file cmsis.h (180.ARM_Peripherals/Project_Headers/cmsis.h)</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: 20Feb.,2017</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Author: podonoghue</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#ifndef PROJECT_HEADERS_CMSIS_H_</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define PROJECT_HEADERS_CMSIS_H_</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;cmsis_os.h&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hardware_8h.html">hardware.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * Namespace enclosing wrapper classes for CMSIS-RTX</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="namespace_c_m_s_i_s.html">   16</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_c_m_s_i_s.html">CMSIS</a> {</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="namespace_c_m_s_i_s.html#ab5fc5a2b5f47fd3a66186eb6a3271dfb">   18</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_c_m_s_i_s.html#ab5fc5a2b5f47fd3a66186eb6a3271dfb">Callback</a> = void (*)(<span class="keyword">const</span> <span class="keywordtype">void</span> *);</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * Wrapper for CMSIS Timer</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * A timer allows the scheduling of the execution of a callback function after a particular</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * delay(osTimerOnce mode) or at a regular interval (osTimerPeriodic mode).</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * Example:</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * @code</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * //</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * // Timer example</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * //</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * void timerExample() {</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> *    // auto function used as call-backs</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> *    static auto cb1 = [] (const void *) {</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> *       RED_LED::toggle();</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> *    };</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> *    static auto cb2 = [] (const void *) {</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> *       GREEN_LED::toggle();</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> *    };</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> *    // Create the two timer being used</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> *    static CMSIS::Timer myTimer1(cb1, osTimerPeriodic);</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> *    static CMSIS::Timer myTimer2(cb2, osTimerPeriodic);</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> *    RED_LED::setOutput();</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> *    GREEN_LED::setOutput();</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> *    // Start the timers </span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> *    myTimer2.start(500);</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> *    myTimer1.start(1000);</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> *    printf(&quot; myTimer1::getId() = %p\n\r&quot;, myTimer1.getId());</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> *    printf(&quot; myTimer2::getId() = %p\n\r&quot;, myTimer2.getId());</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> * }</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> * @endcode</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html">   56</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_m_s_i_s_1_1_timer.html">Timer</a> {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">    * Based on os_timer_cb in rt_CMSIS.c</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">    * Timer Control Block</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html">   63</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html">osTimerControlBlock_t</a> {</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a3bbc4b2c70d1a6fd1c1e595b65c596e0">   64</a></span>&#160;      <span class="keyword">struct </span>os_timer_cb_ *<a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a3bbc4b2c70d1a6fd1c1e595b65c596e0">next</a>;   <span class="comment">// Pointer to next active Timer</span></div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#aa6c426196c10f2a72f7c117a3875c8d4">   65</a></span>&#160;      uint8_t             <a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#aa6c426196c10f2a72f7c117a3875c8d4">state</a>;   <span class="comment">// Timer State</span></div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#ac4799f635b87bcc325308d6c333f4259">   66</a></span>&#160;      uint8_t              <a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#ac4799f635b87bcc325308d6c333f4259">type</a>;   <span class="comment">// Timer Type (Periodic/One-shot)</span></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a2903668d80e9b4d12e3d907ab1a82167">   67</a></span>&#160;      uint16_t         <a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a2903668d80e9b4d12e3d907ab1a82167">reserved</a>;   <span class="comment">// Reserved</span></div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#ab23ebce72952d06fcf42c50cb4642553">   68</a></span>&#160;      uint32_t             <a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#ab23ebce72952d06fcf42c50cb4642553">tcnt</a>;   <span class="comment">// Timer Delay Count</span></div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a30f3ee41bb9ae5f4f2609bb4d717b325">   69</a></span>&#160;      uint32_t             <a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a30f3ee41bb9ae5f4f2609bb4d717b325">icnt</a>;   <span class="comment">// Timer Initial Count</span></div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a527b0d030977f0e76a2b228d2df65ef0">   70</a></span>&#160;      <span class="keywordtype">void</span>                 *<a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a527b0d030977f0e76a2b228d2df65ef0">arg</a>;   <span class="comment">// Timer Function Argument</span></div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a9001cc75aeefd00548934c2e8ee73bdb">   71</a></span>&#160;      <span class="keyword">const</span> osTimerDef_t *<a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a9001cc75aeefd00548934c2e8ee73bdb">timer</a>;   <span class="comment">// Pointer to Timer definition</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   };</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#a1ae6910e486479644e09a87fd9192807">   74</a></span>&#160;   <a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html">osTimerControlBlock_t</a>  <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a1ae6910e486479644e09a87fd9192807">os_timer_cb</a>  = {0,0,0,0,0,0,0,0};</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#a265275e7de00716a94fd8b71eeb9e890">   75</a></span>&#160;   <span class="keyword">const</span> osTimerDef_t     <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a265275e7de00716a94fd8b71eeb9e890">os_timer_def</a>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">    * Constructor - Create timer</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">    * @param[in] callback  Call-back function to execute by timer</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">    * @param[in] argument  Pointer to data to pass to callback (should be persistent)</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">    * @param[in] timerType Type of timer e.g. osTimerPeriodic, osTimerOnce</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#a7048891c78454a81726f341857509169">   85</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a7048891c78454a81726f341857509169">Timer</a>(<a class="code" href="namespace_c_m_s_i_s.html#ab5fc5a2b5f47fd3a66186eb6a3271dfb">Callback</a> callback, <span class="keywordtype">void</span> *argument, os_timer_type timerType) :</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;     os_timer_def{callback, (<span class="keywordtype">void</span>*)&amp;os_timer_cb} {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      osTimerId timer_id __attribute__((unused)) = osTimerCreate(&amp;os_timer_def, timerType, argument);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      assert((<span class="keywordtype">void</span>*)timer_id == (<span class="keywordtype">void</span>*)&amp;os_timer_cb);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">    * Constructor - Create timer of given type</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">    * @param[in] callback  Call-back function to execute by timer</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">    * @param[in] timerType Type of timer e.g. osTimerPeriodic, osTimerOnce</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#a01e5128acafdcfbb70b19847ed5a0d8a">   96</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a01e5128acafdcfbb70b19847ed5a0d8a">Timer</a>(<a class="code" href="namespace_c_m_s_i_s.html#ab5fc5a2b5f47fd3a66186eb6a3271dfb">Callback</a> callback, os_timer_type timerType) :</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="class_c_m_s_i_s_1_1_timer.html">Timer</a>(callback, nullptr, timerType) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">    * Constructor - Create Periodic timer</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">    * @param[in] callback  Call-back function to execute by timer</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">    * @param[in] argument  Pointer to data to pass to callback (should be persistent)</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#a96b762bb31988a8b4fa4f5133e4f8b55">  105</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a96b762bb31988a8b4fa4f5133e4f8b55">Timer</a>(<a class="code" href="namespace_c_m_s_i_s.html#ab5fc5a2b5f47fd3a66186eb6a3271dfb">Callback</a> callback, <span class="keywordtype">void</span> *argument=<span class="keyword">nullptr</span>) :</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="class_c_m_s_i_s_1_1_timer.html">Timer</a>(callback, argument, osTimerPeriodic){</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">    * Destructor</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#a3de140dec145173653e48ebc551664ef">  111</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a3de140dec145173653e48ebc551664ef">~Timer</a>() {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">if</span> (os_timer_cb.<a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#aa6c426196c10f2a72f7c117a3875c8d4">state</a> != 0) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;         <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a997874cb999b292308b0bbe5ba9ed62b">destroy</a>();</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">    * Recreate the associated CMSIS timer with different characteristics</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">    * @param[in] argument  Pointer to data to pass to callback (should be persistent)</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">    * @param[in] timerType Type of timer e.g. osTimerPeriodic, osTimerOnce</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">    * @return true  Success</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">    * @return false Failure</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#ab1ff38ed2a8339974d60f1b60387f1bb">  125</a></span>&#160;   <span class="keywordtype">bool</span> <a class="code" href="class_c_m_s_i_s_1_1_timer.html#ab1ff38ed2a8339974d60f1b60387f1bb">create</a>(<span class="keywordtype">void</span> *argument=<span class="keyword">nullptr</span>, os_timer_type timerType=osTimerPeriodic) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      osTimerId timer_id __attribute__((unused)) = osTimerCreate(&amp;os_timer_def, timerType, argument);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">return</span> ((<span class="keywordtype">void</span>*)timer_id == (<span class="keywordtype">void</span>*)&amp;os_timer_cb);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">    * Destroy the associated CMSIS timer</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">    * @return error code:</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">    * @return - osOK:              The timer has been deleted.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">    * @return - osErrorISR:        Cannot be called from interrupt service routines.</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">    * @return - osErrorParameter:  Parameter is incorrect</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#a997874cb999b292308b0bbe5ba9ed62b">  137</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a997874cb999b292308b0bbe5ba9ed62b">destroy</a>() {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">return</span> osTimerDelete((osTimerId)&amp;os_timer_cb);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">    * Stop the timer</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#aa358ac4b76cc48428ca06667c1c2e606">  143</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="class_c_m_s_i_s_1_1_timer.html#aa358ac4b76cc48428ca06667c1c2e606">stop</a>() {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      osTimerStop((osTimerId)&amp;os_timer_cb);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">    * Start or restart timer</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">    * @param[in] millisec Interval in milliseconds</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#aa69da4e44350866b31f22b9946092d73">  151</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="class_c_m_s_i_s_1_1_timer.html#aa69da4e44350866b31f22b9946092d73">start</a>(<span class="keywordtype">int</span> millisec) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      USBDM::setAndCheckCmsisErrorCode(osTimerStart((osTimerId)&amp;os_timer_cb, millisec));</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">    * Start or restart timer</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">    * @param[in] interval Interval in seconds</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#a47162a10a8f968b2edf5cfd472a3186c">  159</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a47162a10a8f968b2edf5cfd472a3186c">start</a>(<span class="keywordtype">double</span> interval) {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="class_c_m_s_i_s_1_1_timer.html#aa69da4e44350866b31f22b9946092d73">start</a>((<span class="keywordtype">int</span>)round(interval*1000.0));</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">    * Get timer ID</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">    * @return CMSIS Timer ID</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer.html#a0cb7c341b1261e8dc3b6814597f4dc72">  167</a></span>&#160;   <span class="keyword">inline</span> osTimerId <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a0cb7c341b1261e8dc3b6814597f4dc72">getId</a>() {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="keywordflow">return</span> (osTimerId)&amp;<a class="code" href="class_c_m_s_i_s_1_1_timer.html#a1ae6910e486479644e09a87fd9192807">os_timer_cb</a>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;};</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"> * Wrapper for CMSIS Timer.</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> * This class incorporates the call-back function.</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> * @tparam timerType Type of timer e.g. osTimerPeriodic, osTimerOnce</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"> * &lt;b&gt;Example declaration&lt;/b&gt;</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> * @code</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> *  //</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> *  // Thread class incorporating thread function</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> *  //</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> *  class MyTimer : public CMSIS::TimerClass {</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> *  private:</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> *     // Name to use</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"> *     const char *fName;</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> *     //</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> *     // Function executed as timer call-back</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> *     //</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> *     virtual void callback(void *) override {</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> *        printf(fName);</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> *     }</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> *  public:</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> *     //</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> *     // Constructor</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> *     //</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"> *     // @param[in] Name for timer function to report</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> *     //</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> *     MyThread(const char *name) : fName(name) {</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"> *     }</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"> *  };</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> * @endcode</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> * &lt;b&gt;Example instantiation and use&lt;/b&gt;</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> * @code</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> *    //</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> *    // Create derived thread class instances</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> *    //</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> *    MyTimer myTimer1(&quot;Timer 1&quot;);</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> *    MyTimer myTimer2(&quot;Timer 2&quot;);</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"> *    // Start timers</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"> *    myTimer1.start(1000);</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"> *    myTimer2.start(500);</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"> * @endcode</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer_class.html">  222</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_m_s_i_s_1_1_timer_class.html">TimerClass</a> : <a class="code" href="class_c_m_s_i_s_1_1_timer.html">Timer</a> {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">    * Derived classes must override this function to implement the thread\n</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">    * This would usually be an endless loop</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <span class="keyword">virtual</span> <span class="keywordtype">void</span> callback() = 0;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">    * Shim to allow use of a static call-back needed by CMSIS timer</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">    * @param[in] arg Pointer to TimerClass instance</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">    * Strictly should be a separate non-member function with C linkage.</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer_class.html#aabd7a3760bb3c78626c503ce713a9a74">  239</a></span>&#160;   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_c_m_s_i_s_1_1_timer_class.html#aabd7a3760bb3c78626c503ce713a9a74">shim</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a527b0d030977f0e76a2b228d2df65ef0">arg</a>) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <a class="code" href="class_c_m_s_i_s_1_1_timer_class.html">TimerClass</a> *This = <span class="keyword">static_cast&lt;</span><a class="code" href="class_c_m_s_i_s_1_1_timer_class.html">TimerClass</a> *<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span> *<span class="keyword">&gt;</span>(<a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a527b0d030977f0e76a2b228d2df65ef0">arg</a>));</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      This-&gt;<a class="code" href="class_c_m_s_i_s_1_1_timer_class.html#a0a29013949a2629852f1ff121724d6f6">callback</a>();</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <span class="comment">// Hide these</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_timer.html#ab1ff38ed2a8339974d60f1b60387f1bb">Timer::create</a>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a997874cb999b292308b0bbe5ba9ed62b">Timer::destroy</a>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_timer.html#aa69da4e44350866b31f22b9946092d73">Timer::start</a>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_timer.html#aa358ac4b76cc48428ca06667c1c2e606">Timer::stop</a>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_timer.html#a0cb7c341b1261e8dc3b6814597f4dc72">Timer::getId</a>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer_class.html#aff825ad5dcdb960769ed4742a8f416a2">  253</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_timer_class.html#aff825ad5dcdb960769ed4742a8f416a2">TimerClass</a>(os_timer_type timerType=osTimerPeriodic) : <a class="code" href="class_c_m_s_i_s_1_1_timer.html">Timer</a>(shim, this, timerType) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   }</div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_timer_class.html#ae5c957369f7346027bef97abfe32fcce">  255</a></span>&#160;   <span class="keyword">virtual</span> <a class="code" href="class_c_m_s_i_s_1_1_timer_class.html#ae5c957369f7346027bef97abfe32fcce">~TimerClass</a>() {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;};</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"> * Wrapper for CMSIS mutex</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"> * A Mutex can be used to:</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"> *    - Synchronize the execution of threads</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> *    - Protect access to shared resources. (Implement critical region protection).</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> * @note Mutex cannot be used in an ISR</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mutex.html">  268</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_m_s_i_s_1_1_mutex.html">Mutex</a> {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mutex.html#a3f3123fa5e140d1926a5b81aceb1b90d">  271</a></span>&#160;   uint32_t           os_mutex_cb[4] = { 0 };</div><div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mutex.html#a3dafa61e4909c6345133a7877688ecbb">  272</a></span>&#160;   <span class="keyword">const</span> osMutexDef_t os_mutex_def   = {os_mutex_cb};</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">    * Create mutex</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mutex.html#aa4c1ad556dbbd9ce354323f55f330991">  278</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_mutex.html#aa4c1ad556dbbd9ce354323f55f330991">Mutex</a>() {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      osMutexId mutex_id __attribute__((unused)) = osMutexCreate(&amp;os_mutex_def);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      assert((<span class="keywordtype">void</span>*)mutex_id == (<span class="keywordtype">void</span>*)os_mutex_cb);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">    * Delete mutex</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mutex.html#a25d5b8748d2f6977cda2f66b39e46aa7">  285</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_mutex.html#a25d5b8748d2f6977cda2f66b39e46aa7">~Mutex</a>() {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      osMutexDelete((osMutexId) os_mutex_cb);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">    * Obtain mutex</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">    * This method may wait until the mutex is available.\n</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">    * The millisec parameter allow the wait time to be specified.</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">    * @param[in] millisec How long to wait in milliseconds.\n</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">    *                     Use osWaitForever for an indefinite wait\n</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">    *                     Use 0 to immediately fail if the mutex is not available.</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">    * @return osOK:                    The mutex has been obtained.</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">    * @return osErrorTimeoutResource:  The mutex could not be obtained in the given time.</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">    * @return osErrorResource:         The mutex could not be obtained when no timeout was specified.</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">    * @return osErrorParameter:        The parameter mutex_id is incorrect.</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">    * @return osErrorISR:              osMutexWait cannot be called from interrupt service routines.</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mutex.html#a14664c6f781ff30d23b4fec5519ab301">  304</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_mutex.html#a14664c6f781ff30d23b4fec5519ab301">wait</a>(uint32_t millisec=osWaitForever) {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordflow">return</span> osMutexWait((osMutexId) os_mutex_cb, millisec);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">    * Release mutex</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">    * Release the mutex that was obtained with wait().\n</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">    * Other threads that are currently waiting for this mutex will be put into the READY state.</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">    * @return osOK:              The mutex has been correctly released.</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">    * @return osErrorResource:   The mutex was not obtained beforehand.</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">    * @return osErrorISR:        osMutexRelease cannot be called from interrupt service routines.</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mutex.html#a31b508c15b0808eb895c8a24d4a7c7b7">  317</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_mutex.html#a31b508c15b0808eb895c8a24d4a7c7b7">release</a>() {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">return</span> osMutexRelease((osMutexId) os_mutex_cb);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">    * Obtain mutex\n</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">    * See @ref wait();</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mutex.html#a61c8a789cc7b772b1070bee7c96e0d50">  324</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_mutex.html#a61c8a789cc7b772b1070bee7c96e0d50">lock</a>(uint32_t millisec=osWaitForever) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordflow">return</span> osMutexWait((osMutexId) os_mutex_cb, millisec);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">    * Try to obtain mutex with immediate fail if unsuccessful.</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">    * @return osOK:                   The mutex has been obtain.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">    * @return osErrorTimeoutResource: The mutex could not be obtained immediately.</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mutex.html#a209ac634b372a1201bcbd251fdb860bb">  333</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_mutex.html#a209ac634b372a1201bcbd251fdb860bb">tryLock</a>() {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">return</span> osMutexWait((osMutexId) os_mutex_cb, 0);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">    * Unlock mutex\n</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">    * See @ref release()</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mutex.html#abf583aabc8a93f25559bc20d913df661">  340</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_mutex.html#abf583aabc8a93f25559bc20d913df661">unlock</a>() {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">return</span> osMutexRelease((osMutexId) os_mutex_cb);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">    * Get mutex ID</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">    * @return CMSIS mutex ID</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mutex.html#a6706589400823ef52b20dc266fc1b62f">  348</a></span>&#160;   osMutexId <a class="code" href="class_c_m_s_i_s_1_1_mutex.html#a6706589400823ef52b20dc266fc1b62f">getID</a>() {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">return</span> (osMutexId) os_mutex_cb;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;};<span class="comment"></span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"> * Wrapper for CMSIS Semaphore</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_semaphore.html">  355</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_m_s_i_s_1_1_semaphore.html">Semaphore</a> {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_semaphore.html#a386e0d87a6419102a5e693c9e750ce34">  358</a></span>&#160;   uint32_t               os_semaphore_cb[2] = { 0 };</div><div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_semaphore.html#ad8c0897aa6dd0e394aeeae8a4ec662a1">  359</a></span>&#160;   <span class="keyword">const</span> osSemaphoreDef_t os_semaphore_def   = { os_semaphore_cb };</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">    * Create semaphore</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">    * @param[in] count Number of available resources.</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_semaphore.html#a38527008cc03b62cc34573a3442336b4">  367</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_semaphore.html#a38527008cc03b62cc34573a3442336b4">Semaphore</a>(int32_t count) {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      osSemaphoreId semaphore_id __attribute__((unused)) = osSemaphoreCreate(&amp;os_semaphore_def, count);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      assert((<span class="keywordtype">void</span>*)semaphore_id == (<span class="keywordtype">void</span>*)os_semaphore_cb);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">    * Delete semaphore</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_semaphore.html#a1a394802e0f76611698ecd3b253f374c">  374</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_semaphore.html#a1a394802e0f76611698ecd3b253f374c">~Semaphore</a>() {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      osSemaphoreDelete((osSemaphoreId)os_semaphore_cb);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">    * Obtain semaphore</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">    * @param[in] millisec How long to wait in milliseconds. Use osWaitForever for indefinite wait</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">    * @return Number of available tokens, or -1 in case of incorrect parameters.</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_semaphore.html#a943286272cd3613445523232d21c59a6">  384</a></span>&#160;   int32_t <a class="code" href="class_c_m_s_i_s_1_1_semaphore.html#a943286272cd3613445523232d21c59a6">wait</a>(uint32_t millisec=osWaitForever) {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      int32_t rc = osSemaphoreWait((osSemaphoreId)os_semaphore_cb, millisec);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      assert(rc &gt;= 0);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">    * Release semaphore</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_semaphore.html#afee15019c943625da9feb26066db9cbb">  392</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="class_c_m_s_i_s_1_1_semaphore.html#afee15019c943625da9feb26066db9cbb">release</a>() {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      osStatus status __attribute__((unused)) = osSemaphoreRelease((osSemaphoreId)os_semaphore_cb);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      assert(status == osOK);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">    * Get semaphore ID</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">    * @return CMSIS semaphore ID</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_semaphore.html#ac065bd529b08e31583f6f49a191e1ebb">  401</a></span>&#160;   osSemaphoreId <a class="code" href="class_c_m_s_i_s_1_1_semaphore.html#ac065bd529b08e31583f6f49a191e1ebb">getID</a>() {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">return</span> (osSemaphoreId)os_semaphore_cb;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;};</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"> * Wrapper for CMSIS Memory Allocation Pool</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"> * This allows a pool of same-size items to be created.\n</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"> * Items can be allocated and freed from the pool.\n</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"> * The main purpose is to avoid fragmentation inherent in the usual C allocation methods</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"> * @tparam T      Type of items in pool</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"> * @tparam size   Size of pool in items</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"> * Example:</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"> * @code</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"> * //</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"> * // Memory pools example</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"> * //</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"> * void memoryPoolExample() {</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"> *    struct Data {</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"> *       int a;</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"> *       int b;</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"> *    };</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"> *    Pool&lt;Data, 10&gt; pool;</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"> *    printf(&quot; memory pool::getId() = %p\n\r&quot;, pool.getId());</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"> *    Data *ar[30] = {0};</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"> *    for (unsigned i=0; i&lt;(sizeof(ar)/sizeof(ar[0])); i++) {</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"> *       ar[i] = pool.alloc();</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment"> *       if (ar[i] == nullptr) {</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"> *          break;</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"> *       }</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"> *       else {</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"> *          printf(&quot;%d: Allocated %p\n\r&quot;, i, ar[i]);</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment"> *       }</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"> *       ar[i]-&gt;a = i;</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"> *       ar[i]-&gt;b = i*i;</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"> *    }</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"> *    for (unsigned i=0; i&lt;(sizeof(ar)/sizeof(ar[0])); i++) {</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"> *       if (ar[i] != nullptr) {</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"> *          printf(&quot;%d: free %p (%d, %d)\n\r&quot;, i, ar[i], ar[i]-&gt;a, ar[i]-&gt;b);</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"> *          pool.free(ar[i]);</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment"> *       }</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"> *    }</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment"> * }</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"> * @endcode</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">size_t</span> size&gt;</div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_pool.html">  453</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_m_s_i_s_1_1_pool.html">Pool</a> {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_pool.html#a852965ef5a989d06a40d842a5ed8a91b">  456</a></span>&#160;   uint32_t pool[3+((<span class="keyword">sizeof</span>(T)+3)/4)*size] = {0};</div><div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_pool.html#ae30e88147cfdc4241a7156b82d1a2e32">  457</a></span>&#160;   <span class="keyword">const</span> osPoolDef_t os_pool_def                 = { size, <span class="keyword">sizeof</span>(T), pool };</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_pool.html#aa75b71fd681312484d7f889506e1f7c9">  460</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_pool.html#aa75b71fd681312484d7f889506e1f7c9">Pool</a>() {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   }</div><div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_pool.html#a92709e542909617d638696c6a1f5fabe">  462</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_pool.html#a92709e542909617d638696c6a1f5fabe">~Pool</a>() {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">    * Create pool</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_pool.html#a17a4bc41b4dc754355ca8375cb443911">  468</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="class_c_m_s_i_s_1_1_pool.html#a17a4bc41b4dc754355ca8375cb443911">create</a>() {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      osPoolId pool_id = osPoolCreate(&amp;os_pool_def);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      assert((<span class="keywordtype">void</span>*)pool_id == (<span class="keywordtype">void</span>*)pool);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">    * Allocate a memory block from the memory pool.</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">    * @return Address of the allocated memory block or nullptr in case of no memory available.</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00477"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_pool.html#a0308310b9fa9619a8fedaaff3dd351fe">  477</a></span>&#160;   T *<a class="code" href="class_c_m_s_i_s_1_1_pool.html#a0308310b9fa9619a8fedaaff3dd351fe">alloc</a>() {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">if</span> ((pool[0] == 0)&amp;&amp;(pool[1] == 0)) {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;         <span class="comment">// Lazy creation</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;         <a class="code" href="class_c_m_s_i_s_1_1_timer.html#ab1ff38ed2a8339974d60f1b60387f1bb">create</a>();</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordflow">return</span> (T*)osPoolAlloc((osPoolId)pool);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">    * Allocate a memory block from the memory pool and initialise to all zeroes.</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">    * @return Address of the allocated memory block or nullptr in case of no memory available.</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_pool.html#a47ad2579aec958af0eae7fc5abd8f5a7">  489</a></span>&#160;   T *<a class="code" href="class_c_m_s_i_s_1_1_pool.html#a47ad2579aec958af0eae7fc5abd8f5a7">calloc</a>() {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">if</span> (pool[0] == 0) {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;         <span class="comment">// Lazy creation</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;         <a class="code" href="class_c_m_s_i_s_1_1_timer.html#ab1ff38ed2a8339974d60f1b60387f1bb">create</a>();</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordflow">return</span> (T*)osPoolCAlloc((osPoolId)pool);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">    * Return a memory block to a memory pool.</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">    * @param[in] buffer Address of buffer to return to pool</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">    * @return osOK:             The memory block is released.</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">    * @return osErrorValue:     Block does not belong to the memory pool.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">    * @return osErrorParameter: A parameter is invalid or outside of a permitted range.</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_pool.html#a9ab6958cfff50bd5eedd684153f56907">  505</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="class_c_m_s_i_s_1_1_pool.html#a9ab6958cfff50bd5eedd684153f56907">free</a>(T *buffer) {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      osStatus status = osPoolFree((osPoolId)pool, buffer);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      assert(status == osOK);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">    * Get pool ID</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">    * @return CMSIS pool ID</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00514"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_pool.html#af66f6dfb20f654686fa57022a410a728">  514</a></span>&#160;   osPoolId <a class="code" href="class_c_m_s_i_s_1_1_pool.html#af66f6dfb20f654686fa57022a410a728">getId</a>() {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">return</span> (osPoolId)pool;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;};</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"> * Wrapper for CMSIS Thread</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"> * @code</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment"> * //</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"> * // Thread example</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment"> * //</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment"> * void threadExample() {</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"> *    static auto threadFn = [] (const void *) {</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"> *       for(;;) {</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"> *          BLUE_LED::toggle();</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment"> *          osDelay(2000);</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"> *       }</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"> *    };</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment"> *    static Thread thread(threadFn);</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment"> *    BLUE_LED::setOutput();</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"> *    thread.run();</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"> *    printf(&quot; thread::getId() = %p\n\r&quot;, thread.getId());</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment"> * }</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"> * @endcode</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html">  542</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_m_s_i_s_1_1_thread.html">Thread</a> {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00545"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#af711a84eef681060a8ef759fce055df0">  545</a></span>&#160;   <span class="keyword">const</span> osThreadDef_t <a class="code" href="class_c_m_s_i_s_1_1_thread.html#af711a84eef681060a8ef759fce055df0">thread_def</a>;</div><div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#a9a894510f5e4a6ea583828169d5942bf">  546</a></span>&#160;   osThreadId thread_id = 0;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">    * Run thread</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">    * @param[in] argument Argument to thread function</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#ae4a0510dbc8eb0f4011be4b796b66d28">  554</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="class_c_m_s_i_s_1_1_thread.html#ae4a0510dbc8eb0f4011be4b796b66d28">run</a>(<span class="keywordtype">void</span> *argument=<span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      thread_id = osThreadCreate(&amp;thread_def, argument);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      USBDM::setAndCheckCmsisErrorCode((thread_id != <span class="keyword">nullptr</span>)?osOK:osErrorOS);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">    * Get thread ID</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">    * @return ID of thread</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#abef0001c33df604e44e05189ce7f32b8">  563</a></span>&#160;   osThreadId <a class="code" href="class_c_m_s_i_s_1_1_thread.html#abef0001c33df604e44e05189ce7f32b8">getId</a>() {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keywordflow">return</span> thread_id;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">    * Get thread ID of current process</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">    * @return ID of thread</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00571"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#a4d064668238a76b00484c57c4d3d7b36">  571</a></span>&#160;   <span class="keyword">static</span> osThreadId <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a4d064668238a76b00484c57c4d3d7b36">getMyId</a>() {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordflow">return</span> osThreadGetId();</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">    * Get thread Priority</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">    * @return Priority of thread</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00579"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#a76a8631f7b4cf8318482c39b0ff38da3">  579</a></span>&#160;   osPriority <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a76a8631f7b4cf8318482c39b0ff38da3">getPriority</a>() {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keywordflow">return</span> osThreadGetPriority(thread_id);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">    * Set thread Priority</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">    * @param[in] priority Priority to set for thread</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">    * @return osOK:              The priority of the thread has been successfully changed.</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">    * @return osErrorValue:      Incorrect priority value.</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">    * @return osErrorResource:   Thread that is not an active thread.</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">    * @return osErrorISR:        Cannot be called from interrupt service routines.</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#ae15dccf32b459bdba6ccd32727b2217d">  592</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_thread.html#ae15dccf32b459bdba6ccd32727b2217d">setPriority</a>(osPriority priority) {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keywordflow">return</span> osThreadSetPriority(thread_id, priority);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">    * Pass control to the next thread that is in state READY.</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">    * If there is no other thread in the state READY, the current</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">    * thread continues execution and no thread switching occurs.</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">    * @return osOK:       The function has been correctly executed.</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">    * @return osErrorISR: Cannot be called from interrupt service routines.</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#a48bcac974975bc098e6cb669f0007a5e">  605</a></span>&#160;   <span class="keyword">static</span> osStatus <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a48bcac974975bc098e6cb669f0007a5e">yield</a>() {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordflow">return</span> osThreadYield();</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">    * Set the specified Signal Flags on the thread</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">    * @param[in] signals Specifies the signal flags of the thread that should be set.</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">    * @return Previous signal flags of the specified thread or 0x80000000 in case of incorrect parameters or call from ISR.</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00616"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#afb8ae05d6f5be34cfec737f3dfe4939c">  616</a></span>&#160;   int32_t <a class="code" href="class_c_m_s_i_s_1_1_thread.html#afb8ae05d6f5be34cfec737f3dfe4939c">signalSet</a>(int32_t signals) {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordflow">return</span> osSignalSet(thread_id, signals);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">    * Clear the specified Signal Flags on the thread</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">    * @param[in] signals Specifies the signal flags of the thread that shall be cleared.</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">    * @return Previous signal flags of the specified thread or 0x80000000 in case of incorrect parameters or call from ISR.</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#a0da915e12f2ab16764e3804c8d3bcfc4">  626</a></span>&#160;   int32_t <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a0da915e12f2ab16764e3804c8d3bcfc4">signalClear</a>(int32_t signals) {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">return</span> osSignalClear(thread_id, signals);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">    * Wait for one or more Signal Flags to become signaled for the current thread.</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">    * @param[in] signals  Wait until all specified signal flags set or 0 for any single signal flag.</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">    * @param[in] millisec How long to wait in milliseconds. Use osWaitForever for indefinite wait</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">    * @return Structure describing event occurring with status:</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">    * @return - osOK: no signal received when the timeout value millisec was 0.</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">    * @return - osEventTimeout: signal not occurred within timeout</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">    * @return - osEventSignal: signal occurred, value.signals contains the signal flags; these signal flags are cleared.</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">    * @return - osErrorValue: the value signals is outside of the permitted range.</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">    * @return - osErrorISR: osSignalWait cannot be called from interrupt service routines.</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00643"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#aab49c70b18997f3f15efbb23e5e1e20f">  643</a></span>&#160;   <span class="keyword">static</span> osEvent <a class="code" href="class_c_m_s_i_s_1_1_thread.html#aab49c70b18997f3f15efbb23e5e1e20f">signalWait</a>(int32_t signals, uint32_t millisec=osWaitForever) {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">return</span> osSignalWait(signals, millisec);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">    * Terminate the thread.</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">    * @return - osOK: the specified thread has been successfully terminated.</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">    * @return - osErrorParameter: thread_id is incorrect.</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">    * @return - osErrorResource: thread_id refers to a thread that is not an active thread.</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">    * @return - osErrorISR: osThreadTerminate cannot be called from interrupt service routines.</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00654"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#a16e3e5e3fa49e3b80cdcf10e2f21ae0a">  654</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a16e3e5e3fa49e3b80cdcf10e2f21ae0a">terminate</a>() {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="keywordflow">return</span> osThreadTerminate(thread_id);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="preprocessor">#if (osFeature_Wait != 0)</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">    * Wait for any event of the type Signal, Message, Mail for a specified time peiod.</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">    * While the system waits the thread that is calling this function is put into the state WAITING. When millisec is set to osWaitForever the function will wait for an infinite time until a event occurs.</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">    * @param[in] millisec How long to wait in milliseconds. Use osWaitForever for indefinite wait.</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">    * @return Status with:</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">    * @return osEventSignal:  Signal event occurred and is returned.</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">    * @return osEventMessage: Message event occurred and is returned.</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">    * @return osEventMail:    Mail event occurred and is returned.</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">    * @return osEventTimeout: Time delay is executed.</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">    * @return osErrorISR:     Cannot be called from interrupt service routines.</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   <span class="keyword">static</span> osStatus <a class="code" href="namespace_u_s_b_d_m.html#ad6cb81f86e2e51358555fe93d0e9dc69">wait</a>(uint32_t millisec) {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">return</span> osWait(millisec);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   }</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">    * Wait for a specified time period in milliseconds.</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">    * @param[in] millisec How long to wait in milliseconds. Use osWaitForever for indefinite wait.</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">    * @return Status with:</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">    * @return osEventTimeout:  The time delay is executed.</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">    * @return osErrorISR:      Cannot be called from interrupt service routines.</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00686"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#a41792bf8f7e265f44e51dc75571c17ae">  686</a></span>&#160;   <span class="keyword">static</span> osStatus <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a41792bf8f7e265f44e51dc75571c17ae">delay</a>(uint32_t millisec) {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="keywordflow">return</span> osDelay(millisec);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">    * Create thread as a wrapper for an existing thread</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">    * @param[in] thread_id   ID of existing thread</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00694"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#a6e5f78e844c5e79e9cf1080df673391f">  694</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a6e5f78e844c5e79e9cf1080df673391f">Thread</a>(osThreadId thread_id) : thread_def{0, osPriorityNormal, 1, 0}, thread_id(thread_id) {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   };<span class="comment"></span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">    * Create thread</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">    * @param[in] threadFunction   Function to execute as the thread</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">    * @param[in] priority         Priority of thread e.g. osPriorityNormal</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">    * @param[in] stackSize        Stack size for thread or 0 to indicate default</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#a597d40d488f6702ba68a4a15703f054c">  703</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a597d40d488f6702ba68a4a15703f054c">Thread</a>(</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;         <a class="code" href="namespace_c_m_s_i_s.html#ab5fc5a2b5f47fd3a66186eb6a3271dfb">Callback</a>    threadFunction,</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;         osPriority  priority=osPriorityNormal,</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;         uint32_t    stackSize=0) : thread_def {threadFunction, priority, 1, stackSize} {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;         };<span class="comment"></span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">         /**</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">          * Delete thread</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00711"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread.html#a9994061c95a57834424015598f636d7f">  711</a></span>&#160;         <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a9994061c95a57834424015598f636d7f">~Thread</a>() {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            osThreadTerminate(thread_id);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;         }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;};</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment"> * Wrapper for CMSIS Thread.</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment"> * This class incorporates the thread function.</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment"> * &lt;b&gt;Example declaration&lt;/b&gt;</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment"> * @code</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment"> *  //</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment"> *  // Thread class incorporating thread function</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment"> *  //</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment"> *  class MyThread : public CMSIS::ThreadClass {</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment"> *  private:</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment"> *     // Name to use</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment"> *     const char *fName;</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment"> *     //</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment"> *     // Function executed as thread</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment"> *     //</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment"> *     virtual void task(void *) override {</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment"> *        for(;;) {</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment"> *           printf(fName);</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment"> *           CMSIS::Thread::delay(300);</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment"> *        }</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment"> *     }</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment"> *  public:</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment"> *     //</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment"> *     // Constructor</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment"> *     //</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"> *     // @param[in] Name for thread function to report</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment"> *     //</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment"> *     MyThread(const char *name) : fName(name) {</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment"> *     }</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment"> *  };</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment"> * @endcode</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment"> * &lt;b&gt;Example instantiation and use&lt;/b&gt;</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment"> * @code</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment"> *    //</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment"> *    // Create derived thread class instances</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment"> *    //</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment"> *    MyThread thread1(&quot;Th 1&quot;);</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment"> *    MyThread thread2(&quot;Th 2&quot;);</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment"> *    // Start threads</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment"> *    thread1.run();</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment"> *    thread2.run();</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment"> * @endcode</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00766"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread_class.html">  766</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_m_s_i_s_1_1_thread_class.html">ThreadClass</a> : <a class="code" href="class_c_m_s_i_s_1_1_thread.html">Thread</a> {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">    * Derived classes must override this function to implement the thread\n</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">    * This would usually be an endless loop</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;   <span class="keyword">virtual</span> <span class="keywordtype">void</span> task() = 0;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">    * Shim to allow use of a static call-back</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">    * @param[in] arg Pointer to ThreadClass instance</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">    * Strictly should be a separate non-member function with C linkage.</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00782"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread_class.html#a7a79d76c237ded1c932d8712af478f67">  782</a></span>&#160;   <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_c_m_s_i_s_1_1_thread_class.html#a7a79d76c237ded1c932d8712af478f67">shim</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a527b0d030977f0e76a2b228d2df65ef0">arg</a>) {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <a class="code" href="class_c_m_s_i_s_1_1_thread_class.html">ThreadClass</a> *This = <span class="keyword">static_cast&lt;</span><a class="code" href="class_c_m_s_i_s_1_1_thread_class.html">ThreadClass</a> *<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span> *<span class="keyword">&gt;</span>(<a class="code" href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a527b0d030977f0e76a2b228d2df65ef0">arg</a>));</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      This-&gt;<a class="code" href="class_c_m_s_i_s_1_1_thread_class.html#aaf68b82240fcca07a1a089d0dbe55993">task</a>();</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;   }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_thread.html#abef0001c33df604e44e05189ce7f32b8">Thread::getId</a>;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a4d064668238a76b00484c57c4d3d7b36">Thread::getMyId</a>;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a76a8631f7b4cf8318482c39b0ff38da3">Thread::getPriority</a>;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_thread.html#ae15dccf32b459bdba6ccd32727b2217d">Thread::setPriority</a>;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a48bcac974975bc098e6cb669f0007a5e">Thread::yield</a>;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_thread.html#afb8ae05d6f5be34cfec737f3dfe4939c">Thread::signalSet</a>;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a0da915e12f2ab16764e3804c8d3bcfc4">Thread::signalClear</a>;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_thread.html#aab49c70b18997f3f15efbb23e5e1e20f">Thread::signalWait</a>;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a16e3e5e3fa49e3b80cdcf10e2f21ae0a">Thread::terminate</a>;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   <span class="keyword">using</span> <a class="code" href="class_c_m_s_i_s_1_1_thread.html#a41792bf8f7e265f44e51dc75571c17ae">Thread::delay</a>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="preprocessor">#if (osFeature_Wait != 0)</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   <span class="keyword">using</span> <a class="code" href="namespace_u_s_b_d_m.html#ad6cb81f86e2e51358555fe93d0e9dc69">Thread::wait</a>;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">    * Create thread</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">    * @param[in] priority         Priority of thread e.g. osPriorityNormal</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">    * @param[in] stackSize        Stack size for thread or 0 to indicate default</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00808"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread_class.html#a82f737935a5efd8b058cb3376f170965">  808</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_thread_class.html#a82f737935a5efd8b058cb3376f170965">ThreadClass</a>(</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;         osPriority  priority=osPriorityNormal,</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;         uint32_t    stackSize=0)</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;   : <a class="code" href="class_c_m_s_i_s_1_1_thread.html">Thread</a>(shim, priority, stackSize) {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;   }</div><div class="line"><a name="l00813"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread_class.html#a831e59cb3fd28c669bf1609ff599a320">  813</a></span>&#160;   <span class="keyword">virtual</span> <a class="code" href="class_c_m_s_i_s_1_1_thread_class.html#a831e59cb3fd28c669bf1609ff599a320">~ThreadClass</a>() {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;   }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_thread_class.html#a1b15e4b1b353a43c644052ba2ab96664">  816</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="class_c_m_s_i_s_1_1_thread_class.html#a1b15e4b1b353a43c644052ba2ab96664">run</a>() {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <a class="code" href="class_c_m_s_i_s_1_1_thread.html#ae4a0510dbc8eb0f4011be4b796b66d28">Thread::run</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;};</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment"> * Wrapper for CMSIS Message Queue</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment"> * Basic approach:</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"> *    - Message queues work in conjunction with a &lt;b&gt;pool&lt;/b&gt; of &lt;b&gt;messages&lt;/b&gt;.</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"> *    - Messages are &lt;b&gt;allocated&lt;/b&gt; from the pool and added to the queue.</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"> *    - Messages are then removed from the queue and &lt;b&gt;freed&lt;/b&gt; after use.</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment"> * @tparam T      Type of items in message queue. Must fit in 32-bits\n</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment"> *                This is typically a simple type like a character or integer or a pointer to</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment"> *                a larger type allocated in some independent fashion.</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment"> * @tparam size   Size of message queue in items</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment"> * Example:</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment"> * @code</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment"> * struct MessageData {</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment"> *    int a;</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment"> *    int b;</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment"> * };</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment"> * static bool messageQueueTestComplete = false;</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment"> * static CMSIS::MessageQueue&lt;MessageData*, 10&gt; messageQueue;</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment"> * void messageQueueSender(const void *) {</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment"> *    MessageData ar[30];</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment"> *    for (unsigned i=0; i&lt;(sizeof(ar)/sizeof(ar[0])); i++) {</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment"> *       ar[i].a = i;</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment"> *       ar[i].b = i*i;</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"> *       printf(&quot;%d: Sending %p (%d, %d)\n\r&quot;, i, &amp;ar[i], ar[i].a, ar[i].b);</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment"> *       osStatus rc = messageQueue.put(&amp;ar[i], 0);</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment"> *       osDelay(100);</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment"> *       if (rc == osErrorResource) {</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment"> *          break;</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment"> *       }</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"> *    }</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment"> *    printf(&quot;=== Sender complete ====\n\r&quot;);</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment"> * }</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment"> * void messageQueueReceiver(const void *) {</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment"> *    for(unsigned i=0; ; i++) {</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment"> *       osEvent event = messageQueue.get(10000);</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment"> *       if (event.status != osEventMessage) {</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment"> *          break;</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment"> *       }</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment"> *       MessageData *data = (MessageData *)event.value.p;</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment"> *       printf(&quot;%d: Received %p (%d, %d)\n\r&quot;, i, data, data-&gt;a, data-&gt;b);</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment"> *    }</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment"> *    messageQueueTestComplete = true;</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment"> *    printf(&quot;=== Receiver complete ====\n\r&quot;);</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment"> * }</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment"> * //</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment"> * // Message Queue example</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment"> * //</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment"> * void messageQueueExample() {</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment"> *    printf(&quot; message messageQueue.getId() = %p\n\r&quot;, messageQueue.getId());</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment"> *    messageQueue.create();</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment"> *    Thread sender(messageQueueSender);</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment"> *    Thread receiver(messageQueueReceiver);</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment"> *    receiver.run();</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment"> *    sender.run();</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment"> *    while(!messageQueueTestComplete) {</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment"> *       __asm__(&quot;nop&quot;);</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment"> *    }</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment"> * }</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment"> * @endcode</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">size_t</span> size, Thread *thread=<span class="keywordtype">nullptr</span>&gt;</div><div class="line"><a name="l00893"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_message_queue.html">  893</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_m_s_i_s_1_1_message_queue.html">MessageQueue</a> {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;   static_assert(<span class="keyword">sizeof</span>(T)&lt;=<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <span class="stringliteral">&quot;Object is too large to pass as message&quot;</span>);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00898"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_message_queue.html#a970ba083db7238180d02d3a427adbb25">  898</a></span>&#160;   uint32_t              queue[4+size] = {0};</div><div class="line"><a name="l00899"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_message_queue.html#a7d0f1ba887897a1ad01ea51988b8242b">  899</a></span>&#160;   <span class="keyword">const</span> osMessageQDef_t os_pool_def   = { size, queue };</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;   <span class="comment">//   static void *operator new     (size_t) = delete;</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;   <span class="comment">//   static void *operator new[]   (size_t) = delete;</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;   <span class="comment">//   static void  operator delete  (void*)  = delete;</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   <span class="comment">//   static void  operator delete[](void*)  = delete;</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00907"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_message_queue.html#a926f794c9ec7a0f2c0b6e913b53067ca">  907</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_message_queue.html#a926f794c9ec7a0f2c0b6e913b53067ca">MessageQueue</a>() {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_message_queue.html#aa272c9e81de84a328c969f4e34899c58">  910</a></span>&#160;   <a class="code" href="class_c_m_s_i_s_1_1_message_queue.html#aa272c9e81de84a328c969f4e34899c58">~MessageQueue</a>() {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">    * Create message queue</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">    * @return osMessageQId or NULL if failed.</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00917"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_message_queue.html#a8e80e4e88c6ba2a63ce592e8b89bedac">  917</a></span>&#160;   osMessageQId <a class="code" href="class_c_m_s_i_s_1_1_message_queue.html#a8e80e4e88c6ba2a63ce592e8b89bedac">create</a>() {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      osThreadId threadId = 0;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keywordflow">if</span> (thread != 0) {</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;         threadId = thread-&gt;getId();</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      }</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      osMessageQId message_id = osMessageCreate(&amp;os_pool_def, threadId);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      assert((<span class="keywordtype">void</span>*)message_id == (<span class="keywordtype">void</span>*)queue);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keywordflow">return</span> message_id;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">    * Put message to queue.</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">    * Returns immediately (for use in ISRs)</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">    * @param[in] info     Message to send</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">    * @return osOK: the message is put into the queue.</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">    * @return osErrorResource: no memory in the queue was available.</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">    * @return osErrorParameter: a parameter is invalid or outside of a permitted range.</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00936"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_message_queue.html#abf5c03426f999426129b0181a33f1b60">  936</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_message_queue.html#abf5c03426f999426129b0181a33f1b60">putISR</a>(T info) {</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <span class="keywordflow">return</span> osMessagePut((osMessageQId)queue, (uint32_t)info, 0);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">    * Put message to queue with timeout</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">    * @param[in] info     Message to enter</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">    * @param[in] millisec How long to wait in milliseconds. Use osWaitForever for indefinite wait</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">    * @return osOK: the message is put into the queue.</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">    * @return osErrorResource: no memory in the queue was available.</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">    * @return osErrorTimeoutResource: no memory in the queue was available during the given time limit.</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">    * @return osErrorParameter: a parameter is invalid or outside of a permitted range.</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00950"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_message_queue.html#a93c5eaa5d5294eeafaaab86cd496b644">  950</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_message_queue.html#a93c5eaa5d5294eeafaaab86cd496b644">put</a>(T info, uint32_t millisec=osWaitForever) {</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <span class="keywordflow">if</span> ((queue[0]==0) &amp;&amp; (queue[1]==0)) {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;         <a class="code" href="class_c_m_s_i_s_1_1_timer.html#ab1ff38ed2a8339974d60f1b60387f1bb">create</a>();</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keywordflow">return</span> osMessagePut((osMessageQId)queue, (uint32_t)info, millisec);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">    * Get message from queue.</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">    * @param[in] millisec How long to wait in milliseconds. Use osWaitForever for indefinite wait</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">    * @return Status and Error Codes</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">    * @return osOK: no message is available in the queue and no timeout was specified.</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">    * @return osEventTimeout: no message has arrived during the given timeout period.</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">    * @return osEventMessage: message received, value.p contains the pointer to message.</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">    * @return osErrorParameter: a parameter is invalid or outside of a permitted range.</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00967"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_message_queue.html#aed443560faa629a61dc772a8d953a7d1">  967</a></span>&#160;   osEvent <span class="keyword">get</span>(uint32_t millisec=osWaitForever) {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keywordflow">if</span> ((queue[0]==0) &amp;&amp; (queue[1]==0)) {</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;         <a class="code" href="class_c_m_s_i_s_1_1_timer.html#ab1ff38ed2a8339974d60f1b60387f1bb">create</a>();</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keywordflow">return</span> osMessageGet((osMessageQId)queue, millisec);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">    * Get message from queue.</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">    * Returns immediately (for use in ISRs)</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">    * @return Status and Error Codes</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">    * @return osOK: no message is available in the queue.</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">    * @return osEventMessage: message received, value.p contains the pointer to message.</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">    * @return osErrorParameter: a parameter is invalid or outside of a permitted range.</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00982"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_message_queue.html#a2be7c1c03dbc11c19781d93846931d00">  982</a></span>&#160;   osEvent <a class="code" href="class_c_m_s_i_s_1_1_message_queue.html#a2be7c1c03dbc11c19781d93846931d00">getISR</a>() {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      osEvent <span class="keyword">event</span> = osMessageGet((osMessageQId)queue, 0);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      assert (event.status != osErrorParameter);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="keywordflow">return</span> event;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">    * Get pool ID</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">    * @return CMSIS pool ID</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00992"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_message_queue.html#aab26c1c0380350d27aeda6a89a402c3f">  992</a></span>&#160;   osMessageQId <a class="code" href="class_c_m_s_i_s_1_1_message_queue.html#aab26c1c0380350d27aeda6a89a402c3f">getId</a>() {</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keywordflow">return</span> (osMessageQId)queue;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;   }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;};</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment"> * Wrapper for CMSIS MailQueue queue</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment"> * Basic approach:</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment"> *    - Mail queues work in conjunction with a &lt;b&gt;pool&lt;/b&gt; of &lt;b&gt;messages&lt;/b&gt;.</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment"> *    - Messages are &lt;b&gt;allocated&lt;/b&gt; from the pool and added to the mail queue.</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment"> *    - Messages are then removed from the mail queue and &lt;b&gt;freed&lt;/b&gt; after use.</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment"> * @tparam T      Type of items in mail queue (determines size of items in pool)</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment"> * @tparam size   Size of mail queue in items (determines number of items that can be allocated from the pool)</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment"> * Example:</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment"> * @code</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment"> * struct MailData {</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment"> *    int a;</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment"> *    int b;</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment"> * };</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment"> * static bool mailQueueTestComplete = false;</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment"> * static MailQueue&lt;MailData, 10&gt; mailQueue;</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment"> * void mailQueueSender(const void *) {</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment"> *    for (unsigned i=0; i&lt;20; i++) {</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment"> *       MailData *data = mailQueue.alloc(0);</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment"> *       if (data == nullptr) {</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment"> *          break;</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment"> *       }</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment"> *       printf(&quot;%d: Allocated %p\n\r&quot;, i, data);</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment"> *       data-&gt;a = i;</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment"> *       data-&gt;b = i*i;</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment"> *       printf(&quot;%d: Sending   %p (%d, %d)\n\r&quot;, i, &amp;data, data-&gt;a, data-&gt;b);</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment"> *       mailQueue.put(data);</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment"> *       osDelay(100);</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment"> *    }</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment"> *    printf(&quot;=== Sender complete ====\n\r&quot;);</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment"> *    while(!mailQueueTestComplete) {</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment"> *       __asm__(&quot;nop&quot;);</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment"> *    }</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment"> * }</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment"> * void mailQueueReceiver(const void *) {</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment"> *    for(unsigned i=0; ; i++) {</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment"> *       osEvent event = mailQueue.get(5000);</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment"> *       if (event.status != osEventMail) {</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment"> *          break;</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment"> *       }</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment"> *       MailData *data = (MailData *)event.value.p;</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment"> *       printf(&quot;%d: Received  %p (%d, %d)\n\r&quot;, i, data, data-&gt;a, data-&gt;b);</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment"> *       mailQueue.free(data);</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment"> *    }</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment"> *    mailQueueTestComplete = true;</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment"> *    printf(&quot;=== Receiver complete ====\n\r&quot;);</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment"> * }</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment"> * //</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment"> * // Mail queue example</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment"> * //</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment"> * void mailQueueExample() {</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment"> *    printf(&quot; mail mailQueue.getId() = %p\n\r&quot;, mailQueue.getId());</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment"> *    mailQueue.create();</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment"> *    Thread sender(mailQueueSender);</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment"> *    Thread receiver(mailQueueReceiver);</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment"> *    receiver.run();</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment"> *    sender.run();</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment"> *    while(!mailQueueTestComplete) {</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment"> *       __asm__(&quot;nop&quot;);</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment"> *    }</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment"> * }</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment"> * @endcode</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keywordtype">size_t</span> size, Thread *thread=<span class="keywordtype">nullptr</span>&gt;</div><div class="line"><a name="l01074"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html"> 1074</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_m_s_i_s_1_1_mail_queue.html">MailQueue</a> {</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l01077"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#abda5ac8a4c9a06138280b583bd0ccb1e"> 1077</a></span>&#160;   uint32_t            queue[4+size];</div><div class="line"><a name="l01078"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#aa5730807d79c2e56f3767c03be8efb57"> 1078</a></span>&#160;   uint32_t            messages[3+((<span class="keyword">sizeof</span>(T)+3)/4)*size];</div><div class="line"><a name="l01079"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#a1c04379c46f016335ce8dfdd9a606c5f"> 1079</a></span>&#160;   <span class="keyword">const</span>  <span class="keywordtype">void</span>         *pool[2]       = {queue, messages};</div><div class="line"><a name="l01080"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#a6ec937edd564f8e4da01b91a22946f21"> 1080</a></span>&#160;   <span class="keyword">const</span>  os_mailQ_def os_mail_def    = {size, <span class="keyword">sizeof</span>(T), pool};</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   <span class="comment">//   static void *operator new     (size_t) = delete;</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;   <span class="comment">//   static void *operator new[]   (size_t) = delete;</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   <span class="comment">//   static void  operator delete  (void*)  = delete;</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   <span class="comment">//   static void  operator delete[](void*)  = delete;</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">    * Create mail queue</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01091"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#aadd4193772c79b11e90b663de912950e"> 1091</a></span>&#160;   <span class="keywordtype">void</span> <a class="code" href="class_c_m_s_i_s_1_1_mail_queue.html#aadd4193772c79b11e90b663de912950e">create</a>() {</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      osThreadId threadId = 0;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="keywordflow">if</span> (thread != 0) {</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;         threadId = thread-&gt;getId();</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      }</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      osMailQId queue_id __attribute__((unused)) = osMailCreate(&amp;os_mail_def, threadId);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      assert(queue_id == (osMailQId)pool);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">    * Allocate a memory block from the mail queue memory pool</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">    * @param[in] millisec How long to wait in milliseconds. Use osWaitForever for indefinite wait.</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">    * @return Pointer to allocated block or nullptr on failure.</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01106"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#a18fce1233ea2cae9e9e76648452e7437"> 1106</a></span>&#160;   T *<a class="code" href="class_c_m_s_i_s_1_1_mail_queue.html#a18fce1233ea2cae9e9e76648452e7437">alloc</a>(uint32_t millisec=osWaitForever) {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="keywordflow">if</span> ((messages[0]==0) &amp;&amp; (messages[1]==0)) {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;         <a class="code" href="class_c_m_s_i_s_1_1_timer.html#ab1ff38ed2a8339974d60f1b60387f1bb">create</a>();</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      }</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="keywordflow">return</span> (T *) osMailAlloc((os_mailQ_cb *)&amp;pool, millisec);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   }</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">    * Allocate a memory block from the mail queue\n</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">    * For use in ISRs.  It will immediately fail if no buffers are available.</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">    * @return Pointer to allocated block or nullptr on failure.</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">    * @return osOK: the block has been allocated</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">    * @return osErrorParameter: a parameter is invalid or outside of a permitted range.</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01122"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#acf9f231df9e128a2ad4c547faa985940"> 1122</a></span>&#160;   T *<a class="code" href="class_c_m_s_i_s_1_1_mail_queue.html#acf9f231df9e128a2ad4c547faa985940">allocISR</a>() {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">return</span> (T *)osMailAlloc((os_mailQ_cb *)&amp;pool, 0);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;   }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">    * Allocate a memory block from the mail queue and initialise to all zeroes.</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">    * @param[in] millisec How long to wait in milliseconds. Use osWaitForever for indefinite wait.</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">    * @return Pointer to allocated block or nullptr on failure.</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01133"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#a1742519e129d42abaaf5c6bb2ba6c4bd"> 1133</a></span>&#160;   T *<a class="code" href="class_c_m_s_i_s_1_1_mail_queue.html#a1742519e129d42abaaf5c6bb2ba6c4bd">calloc</a>(uint32_t millisec=osWaitForever) {</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      <span class="keywordflow">if</span> ((messages[0]==0) &amp;&amp; (messages[0]==0)) {</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;         <a class="code" href="class_c_m_s_i_s_1_1_timer.html#ab1ff38ed2a8339974d60f1b60387f1bb">create</a>();</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      }</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <span class="keywordflow">return</span> (T *)osMailCAlloc((os_mailQ_cb *)&amp;pool, millisec);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;   }</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">    * Allocate a memory block from the mail queue and initialise to all zeroes.\n</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">    * For use in ISRs.</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">    * @param[in] millisec How long to wait in milliseconds. Use osWaitForever for indefinite wait</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">    * @return Pointer to allocated block or nullptr on failure.</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01148"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#aed980ee02cdc07bdd1e33ec6d4076226"> 1148</a></span>&#160;   T *<a class="code" href="class_c_m_s_i_s_1_1_mail_queue.html#aed980ee02cdc07bdd1e33ec6d4076226">callocISR</a>(uint32_t millisec) {</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      <span class="keywordflow">return</span> (T *)osMailCAlloc((osMailQId)&amp;pool, 0);</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;   }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">    * Free a memory block from the mail queue.</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">    * @param[in] mail Mail block to free (previously allocated with alloc or calloc)</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">    * @return osOK: the mail block is released.</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">    * @return osErrorValue: mail block does not belong to the mail queue pool.</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">    * @return osErrorParameter: the value to the parameter queue_id is incorrect.</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01161"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#a6ab3999ed693c1ac75a7209efdba42bf"> 1161</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_mail_queue.html#a6ab3999ed693c1ac75a7209efdba42bf">free</a>(T *mail) {</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keywordflow">return</span> osMailFree((osMailQId)&amp;pool, mail);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;   }</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">    * Get a mail item from the mail queue.</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">    * @param[in] millisec How long to wait in milliseconds. Use osWaitForever for indefinite wait.</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">    * @return Status with:</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">    * @return osOK: no mail is available in the queue and no timeout was specified</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">    * @return osEventTimeout: no mail has arrived during the given timeout period.</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">    * @return osEventMail: mail received, value.p contains the pointer to mail content.</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">    * @return osErrorParameter: a parameter is invalid or outside of a permitted range.</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01176"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#a48b048b2a259b68bc5ae2a2222c56e9a"> 1176</a></span>&#160;   osEvent <span class="keyword">get</span>(uint32_t millisec=osWaitForever) {</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="keywordflow">return</span> osMailGet((os_mailQ_cb *)&amp;pool, millisec);</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;   }</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">    * Get a mail item from the mail queue.\n</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">    * For use in ISRs</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">    * @return osOK: no mail is available in the queue</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">    * @return osEventMail: mail received, value.p contains the pointer to mail content.</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">    * @return osErrorParameter: a parameter is invalid or outside of a permitted range.</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01188"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#a4ad782d61fe981dfcb70579acb0fd383"> 1188</a></span>&#160;   osEvent <a class="code" href="class_c_m_s_i_s_1_1_mail_queue.html#a4ad782d61fe981dfcb70579acb0fd383">getISR</a>() {</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="keywordflow">return</span> osMailGet((os_mailQ_cb *)&amp;pool, 0);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;   }</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">    * Put a mail item into the mail queue.</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">    * @param[in] mail A mail block previously allocated by alloc() or calloc().</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">    * @return osOK: no mail is available in the queue and no timeout was specified</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">    * @return osErrorValue: mail was previously not allocated as memory slot.</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">    * @return osErrorParameter: a parameter is invalid or outside of a permitted range.</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01201"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#aa01bb57b36d0ae766829797ddfc09983"> 1201</a></span>&#160;   osStatus <a class="code" href="class_c_m_s_i_s_1_1_mail_queue.html#aa01bb57b36d0ae766829797ddfc09983">put</a>(T *mail) {</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      <span class="keywordflow">return</span> osMailPut((os_mailQ_cb *)&amp;pool, mail);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;   }<span class="comment"></span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">   /**</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">    * Get mail queue ID</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">    * @return CMSIS mail queue ID</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01209"></a><span class="lineno"><a class="line" href="class_c_m_s_i_s_1_1_mail_queue.html#af7575e2e38147d39a6c0f854281c5a61"> 1209</a></span>&#160;   osMailQId <a class="code" href="class_c_m_s_i_s_1_1_mail_queue.html#af7575e2e38147d39a6c0f854281c5a61">getId</a>() {</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="keywordflow">return</span> (osMailQId)queue;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;   }</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;};</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;}; <span class="comment">// end namespace CMSIS</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* PROJECT_HEADERS_CMSIS_H_ */</span><span class="preprocessor"></span></div><div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_a47162a10a8f968b2edf5cfd472a3186c"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#a47162a10a8f968b2edf5cfd472a3186c">CMSIS::Timer::start</a></div><div class="ttdeci">void start(double interval)</div><div class="ttdoc">Start or restart timer. </div><div class="ttdef"><b>Definition:</b> cmsis.h:159</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_class_html_ae5c957369f7346027bef97abfe32fcce"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer_class.html#ae5c957369f7346027bef97abfe32fcce">CMSIS::TimerClass::~TimerClass</a></div><div class="ttdeci">virtual ~TimerClass()</div><div class="ttdef"><b>Definition:</b> cmsis.h:255</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_class_html_a7a79d76c237ded1c932d8712af478f67"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread_class.html#a7a79d76c237ded1c932d8712af478f67">CMSIS::ThreadClass::shim</a></div><div class="ttdeci">static void shim(const void *arg)</div><div class="ttdoc">Shim to allow use of a static call-back. </div><div class="ttdef"><b>Definition:</b> cmsis.h:782</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mutex_html_a25d5b8748d2f6977cda2f66b39e46aa7"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mutex.html#a25d5b8748d2f6977cda2f66b39e46aa7">CMSIS::Mutex::~Mutex</a></div><div class="ttdeci">~Mutex()</div><div class="ttdoc">Delete mutex. </div><div class="ttdef"><b>Definition:</b> cmsis.h:285</div></div>
<div class="ttc" id="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t_html_a527b0d030977f0e76a2b228d2df65ef0"><div class="ttname"><a href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a527b0d030977f0e76a2b228d2df65ef0">CMSIS::Timer::osTimerControlBlock_t::arg</a></div><div class="ttdeci">void * arg</div><div class="ttdef"><b>Definition:</b> cmsis.h:70</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_class_html_a0a29013949a2629852f1ff121724d6f6"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer_class.html#a0a29013949a2629852f1ff121724d6f6">CMSIS::TimerClass::callback</a></div><div class="ttdeci">virtual void callback()=0</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_message_queue_html_aab26c1c0380350d27aeda6a89a402c3f"><div class="ttname"><a href="class_c_m_s_i_s_1_1_message_queue.html#aab26c1c0380350d27aeda6a89a402c3f">CMSIS::MessageQueue::getId</a></div><div class="ttdeci">osMessageQId getId()</div><div class="ttdoc">Get pool ID. </div><div class="ttdef"><b>Definition:</b> cmsis.h:992</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_a597d40d488f6702ba68a4a15703f054c"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#a597d40d488f6702ba68a4a15703f054c">CMSIS::Thread::Thread</a></div><div class="ttdeci">Thread(Callback threadFunction, osPriority priority=osPriorityNormal, uint32_t stackSize=0)</div><div class="ttdoc">Create thread. </div><div class="ttdef"><b>Definition:</b> cmsis.h:703</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_a3de140dec145173653e48ebc551664ef"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#a3de140dec145173653e48ebc551664ef">CMSIS::Timer::~Timer</a></div><div class="ttdeci">~Timer()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> cmsis.h:111</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mail_queue_html_aa01bb57b36d0ae766829797ddfc09983"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mail_queue.html#aa01bb57b36d0ae766829797ddfc09983">CMSIS::MailQueue::put</a></div><div class="ttdeci">osStatus put(T *mail)</div><div class="ttdoc">Put a mail item into the mail queue. </div><div class="ttdef"><b>Definition:</b> cmsis.h:1201</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_ae15dccf32b459bdba6ccd32727b2217d"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#ae15dccf32b459bdba6ccd32727b2217d">CMSIS::Thread::setPriority</a></div><div class="ttdeci">osStatus setPriority(osPriority priority)</div><div class="ttdoc">Set thread Priority. </div><div class="ttdef"><b>Definition:</b> cmsis.h:592</div></div>
<div class="ttc" id="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t_html_a30f3ee41bb9ae5f4f2609bb4d717b325"><div class="ttname"><a href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a30f3ee41bb9ae5f4f2609bb4d717b325">CMSIS::Timer::osTimerControlBlock_t::icnt</a></div><div class="ttdeci">uint32_t icnt</div><div class="ttdef"><b>Definition:</b> cmsis.h:69</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mail_queue_html_a6ab3999ed693c1ac75a7209efdba42bf"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mail_queue.html#a6ab3999ed693c1ac75a7209efdba42bf">CMSIS::MailQueue::free</a></div><div class="ttdeci">osStatus free(T *mail)</div><div class="ttdoc">Free a memory block from the mail queue. </div><div class="ttdef"><b>Definition:</b> cmsis.h:1161</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_class_html"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread_class.html">CMSIS::ThreadClass</a></div><div class="ttdoc">Wrapper for CMSIS Thread. </div><div class="ttdef"><b>Definition:</b> cmsis.h:766</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_a997874cb999b292308b0bbe5ba9ed62b"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#a997874cb999b292308b0bbe5ba9ed62b">CMSIS::Timer::destroy</a></div><div class="ttdeci">osStatus destroy()</div><div class="ttdoc">Destroy the associated CMSIS timer. </div><div class="ttdef"><b>Definition:</b> cmsis.h:137</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_message_queue_html_aa272c9e81de84a328c969f4e34899c58"><div class="ttname"><a href="class_c_m_s_i_s_1_1_message_queue.html#aa272c9e81de84a328c969f4e34899c58">CMSIS::MessageQueue::~MessageQueue</a></div><div class="ttdeci">~MessageQueue()</div><div class="ttdef"><b>Definition:</b> cmsis.h:910</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_pool_html_a0308310b9fa9619a8fedaaff3dd351fe"><div class="ttname"><a href="class_c_m_s_i_s_1_1_pool.html#a0308310b9fa9619a8fedaaff3dd351fe">CMSIS::Pool::alloc</a></div><div class="ttdeci">T * alloc()</div><div class="ttdoc">Allocate a memory block from the memory pool. </div><div class="ttdef"><b>Definition:</b> cmsis.h:477</div></div>
<div class="ttc" id="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t_html_ac4799f635b87bcc325308d6c333f4259"><div class="ttname"><a href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#ac4799f635b87bcc325308d6c333f4259">CMSIS::Timer::osTimerControlBlock_t::type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdef"><b>Definition:</b> cmsis.h:66</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_a41792bf8f7e265f44e51dc75571c17ae"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#a41792bf8f7e265f44e51dc75571c17ae">CMSIS::Thread::delay</a></div><div class="ttdeci">static osStatus delay(uint32_t millisec)</div><div class="ttdoc">Wait for a specified time period in milliseconds. </div><div class="ttdef"><b>Definition:</b> cmsis.h:686</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_semaphore_html"><div class="ttname"><a href="class_c_m_s_i_s_1_1_semaphore.html">CMSIS::Semaphore</a></div><div class="ttdoc">Wrapper for CMSIS Semaphore. </div><div class="ttdef"><b>Definition:</b> cmsis.h:355</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_pool_html_a47ad2579aec958af0eae7fc5abd8f5a7"><div class="ttname"><a href="class_c_m_s_i_s_1_1_pool.html#a47ad2579aec958af0eae7fc5abd8f5a7">CMSIS::Pool::calloc</a></div><div class="ttdeci">T * calloc()</div><div class="ttdoc">Allocate a memory block from the memory pool and initialise to all zeroes. </div><div class="ttdef"><b>Definition:</b> cmsis.h:489</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_class_html_a82f737935a5efd8b058cb3376f170965"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread_class.html#a82f737935a5efd8b058cb3376f170965">CMSIS::ThreadClass::ThreadClass</a></div><div class="ttdeci">ThreadClass(osPriority priority=osPriorityNormal, uint32_t stackSize=0)</div><div class="ttdoc">Create thread. </div><div class="ttdef"><b>Definition:</b> cmsis.h:808</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html">CMSIS::Thread</a></div><div class="ttdoc">Wrapper for CMSIS Thread. </div><div class="ttdef"><b>Definition:</b> cmsis.h:542</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mutex_html_a61c8a789cc7b772b1070bee7c96e0d50"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mutex.html#a61c8a789cc7b772b1070bee7c96e0d50">CMSIS::Mutex::lock</a></div><div class="ttdeci">osStatus lock(uint32_t millisec=osWaitForever)</div><div class="ttdoc">Obtain mutex See wait();. </div><div class="ttdef"><b>Definition:</b> cmsis.h:324</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mail_queue_html_a18fce1233ea2cae9e9e76648452e7437"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mail_queue.html#a18fce1233ea2cae9e9e76648452e7437">CMSIS::MailQueue::alloc</a></div><div class="ttdeci">T * alloc(uint32_t millisec=osWaitForever)</div><div class="ttdoc">Allocate a memory block from the mail queue memory pool. </div><div class="ttdef"><b>Definition:</b> cmsis.h:1106</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_message_queue_html_a2be7c1c03dbc11c19781d93846931d00"><div class="ttname"><a href="class_c_m_s_i_s_1_1_message_queue.html#a2be7c1c03dbc11c19781d93846931d00">CMSIS::MessageQueue::getISR</a></div><div class="ttdeci">osEvent getISR()</div><div class="ttdoc">Get message from queue. </div><div class="ttdef"><b>Definition:</b> cmsis.h:982</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_message_queue_html_a926f794c9ec7a0f2c0b6e913b53067ca"><div class="ttname"><a href="class_c_m_s_i_s_1_1_message_queue.html#a926f794c9ec7a0f2c0b6e913b53067ca">CMSIS::MessageQueue::MessageQueue</a></div><div class="ttdeci">MessageQueue()</div><div class="ttdef"><b>Definition:</b> cmsis.h:907</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_semaphore_html_a943286272cd3613445523232d21c59a6"><div class="ttname"><a href="class_c_m_s_i_s_1_1_semaphore.html#a943286272cd3613445523232d21c59a6">CMSIS::Semaphore::wait</a></div><div class="ttdeci">int32_t wait(uint32_t millisec=osWaitForever)</div><div class="ttdoc">Obtain semaphore. </div><div class="ttdef"><b>Definition:</b> cmsis.h:384</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mail_queue_html_acf9f231df9e128a2ad4c547faa985940"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mail_queue.html#acf9f231df9e128a2ad4c547faa985940">CMSIS::MailQueue::allocISR</a></div><div class="ttdeci">T * allocISR()</div><div class="ttdoc">Allocate a memory block from the mail queue For use in ISRs. </div><div class="ttdef"><b>Definition:</b> cmsis.h:1122</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_abef0001c33df604e44e05189ce7f32b8"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#abef0001c33df604e44e05189ce7f32b8">CMSIS::Thread::getId</a></div><div class="ttdeci">osThreadId getId()</div><div class="ttdoc">Get thread ID. </div><div class="ttdef"><b>Definition:</b> cmsis.h:563</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_afb8ae05d6f5be34cfec737f3dfe4939c"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#afb8ae05d6f5be34cfec737f3dfe4939c">CMSIS::Thread::signalSet</a></div><div class="ttdeci">int32_t signalSet(int32_t signals)</div><div class="ttdoc">Set the specified Signal Flags on the thread. </div><div class="ttdef"><b>Definition:</b> cmsis.h:616</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mail_queue_html_aed980ee02cdc07bdd1e33ec6d4076226"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mail_queue.html#aed980ee02cdc07bdd1e33ec6d4076226">CMSIS::MailQueue::callocISR</a></div><div class="ttdeci">T * callocISR(uint32_t millisec)</div><div class="ttdoc">Allocate a memory block from the mail queue and initialise to all zeroes. </div><div class="ttdef"><b>Definition:</b> cmsis.h:1148</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_class_html_a1b15e4b1b353a43c644052ba2ab96664"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread_class.html#a1b15e4b1b353a43c644052ba2ab96664">CMSIS::ThreadClass::run</a></div><div class="ttdeci">void run()</div><div class="ttdef"><b>Definition:</b> cmsis.h:816</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_a7048891c78454a81726f341857509169"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#a7048891c78454a81726f341857509169">CMSIS::Timer::Timer</a></div><div class="ttdeci">Timer(Callback callback, void *argument, os_timer_type timerType)</div><div class="ttdoc">Constructor - Create timer. </div><div class="ttdef"><b>Definition:</b> cmsis.h:85</div></div>
<div class="ttc" id="namespace_u_s_b_d_m_html_ad6cb81f86e2e51358555fe93d0e9dc69"><div class="ttname"><a href="namespace_u_s_b_d_m.html#ad6cb81f86e2e51358555fe93d0e9dc69">USBDM::wait</a></div><div class="ttdeci">void wait(float seconds)</div><div class="ttdoc">Simple delay routine. </div><div class="ttdef"><b>Definition:</b> delay.cpp:139</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_semaphore_html_ac065bd529b08e31583f6f49a191e1ebb"><div class="ttname"><a href="class_c_m_s_i_s_1_1_semaphore.html#ac065bd529b08e31583f6f49a191e1ebb">CMSIS::Semaphore::getID</a></div><div class="ttdeci">osSemaphoreId getID()</div><div class="ttdoc">Get semaphore ID. </div><div class="ttdef"><b>Definition:</b> cmsis.h:401</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mutex_html_a31b508c15b0808eb895c8a24d4a7c7b7"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mutex.html#a31b508c15b0808eb895c8a24d4a7c7b7">CMSIS::Mutex::release</a></div><div class="ttdeci">osStatus release()</div><div class="ttdoc">Release mutex. </div><div class="ttdef"><b>Definition:</b> cmsis.h:317</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_class_html_aff825ad5dcdb960769ed4742a8f416a2"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer_class.html#aff825ad5dcdb960769ed4742a8f416a2">CMSIS::TimerClass::TimerClass</a></div><div class="ttdeci">TimerClass(os_timer_type timerType=osTimerPeriodic)</div><div class="ttdef"><b>Definition:</b> cmsis.h:253</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mail_queue_html"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mail_queue.html">CMSIS::MailQueue</a></div><div class="ttdoc">Wrapper for CMSIS MailQueue queue. </div><div class="ttdef"><b>Definition:</b> cmsis.h:1074</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_a0da915e12f2ab16764e3804c8d3bcfc4"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#a0da915e12f2ab16764e3804c8d3bcfc4">CMSIS::Thread::signalClear</a></div><div class="ttdeci">int32_t signalClear(int32_t signals)</div><div class="ttdoc">Clear the specified Signal Flags on the thread. </div><div class="ttdef"><b>Definition:</b> cmsis.h:626</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_af711a84eef681060a8ef759fce055df0"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#af711a84eef681060a8ef759fce055df0">CMSIS::Thread::thread_def</a></div><div class="ttdeci">const osThreadDef_t thread_def</div><div class="ttdef"><b>Definition:</b> cmsis.h:545</div></div>
<div class="ttc" id="namespace_c_m_s_i_s_html_ab5fc5a2b5f47fd3a66186eb6a3271dfb"><div class="ttname"><a href="namespace_c_m_s_i_s.html#ab5fc5a2b5f47fd3a66186eb6a3271dfb">CMSIS::Callback</a></div><div class="ttdeci">void(*)(const void *) Callback</div><div class="ttdef"><b>Definition:</b> cmsis.h:18</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_pool_html_aa75b71fd681312484d7f889506e1f7c9"><div class="ttname"><a href="class_c_m_s_i_s_1_1_pool.html#aa75b71fd681312484d7f889506e1f7c9">CMSIS::Pool::Pool</a></div><div class="ttdeci">Pool()</div><div class="ttdef"><b>Definition:</b> cmsis.h:460</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_a4d064668238a76b00484c57c4d3d7b36"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#a4d064668238a76b00484c57c4d3d7b36">CMSIS::Thread::getMyId</a></div><div class="ttdeci">static osThreadId getMyId()</div><div class="ttdoc">Get thread ID of current process. </div><div class="ttdef"><b>Definition:</b> cmsis.h:571</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_aa358ac4b76cc48428ca06667c1c2e606"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#aa358ac4b76cc48428ca06667c1c2e606">CMSIS::Timer::stop</a></div><div class="ttdeci">void stop()</div><div class="ttdoc">Stop the timer. </div><div class="ttdef"><b>Definition:</b> cmsis.h:143</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_class_html_aabd7a3760bb3c78626c503ce713a9a74"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer_class.html#aabd7a3760bb3c78626c503ce713a9a74">CMSIS::TimerClass::shim</a></div><div class="ttdeci">static void shim(const void *arg)</div><div class="ttdoc">Shim to allow use of a static call-back needed by CMSIS timer. </div><div class="ttdef"><b>Definition:</b> cmsis.h:239</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_message_queue_html_a8e80e4e88c6ba2a63ce592e8b89bedac"><div class="ttname"><a href="class_c_m_s_i_s_1_1_message_queue.html#a8e80e4e88c6ba2a63ce592e8b89bedac">CMSIS::MessageQueue::create</a></div><div class="ttdeci">osMessageQId create()</div><div class="ttdoc">Create message queue. </div><div class="ttdef"><b>Definition:</b> cmsis.h:917</div></div>
<div class="ttc" id="namespace_c_m_s_i_s_html"><div class="ttname"><a href="namespace_c_m_s_i_s.html">CMSIS</a></div><div class="ttdoc">Namespace enclosing wrapper classes for CMSIS-RTX. </div><div class="ttdef"><b>Definition:</b> cmsis.h:16</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_a16e3e5e3fa49e3b80cdcf10e2f21ae0a"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#a16e3e5e3fa49e3b80cdcf10e2f21ae0a">CMSIS::Thread::terminate</a></div><div class="ttdeci">osStatus terminate()</div><div class="ttdoc">Terminate the thread. </div><div class="ttdef"><b>Definition:</b> cmsis.h:654</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_a76a8631f7b4cf8318482c39b0ff38da3"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#a76a8631f7b4cf8318482c39b0ff38da3">CMSIS::Thread::getPriority</a></div><div class="ttdeci">osPriority getPriority()</div><div class="ttdoc">Get thread Priority. </div><div class="ttdef"><b>Definition:</b> cmsis.h:579</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_ae4a0510dbc8eb0f4011be4b796b66d28"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#ae4a0510dbc8eb0f4011be4b796b66d28">CMSIS::Thread::run</a></div><div class="ttdeci">void run(void *argument=nullptr)</div><div class="ttdoc">Run thread. </div><div class="ttdef"><b>Definition:</b> cmsis.h:554</div></div>
<div class="ttc" id="hardware_8h_html"><div class="ttname"><a href="hardware_8h.html">hardware.h</a></div><div class="ttdoc">(180.ARM_Peripherals/Project_Headers/hardware.h) </div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mail_queue_html_a1742519e129d42abaaf5c6bb2ba6c4bd"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mail_queue.html#a1742519e129d42abaaf5c6bb2ba6c4bd">CMSIS::MailQueue::calloc</a></div><div class="ttdeci">T * calloc(uint32_t millisec=osWaitForever)</div><div class="ttdoc">Allocate a memory block from the mail queue and initialise to all zeroes. </div><div class="ttdef"><b>Definition:</b> cmsis.h:1133</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_a265275e7de00716a94fd8b71eeb9e890"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#a265275e7de00716a94fd8b71eeb9e890">CMSIS::Timer::os_timer_def</a></div><div class="ttdeci">const osTimerDef_t os_timer_def</div><div class="ttdef"><b>Definition:</b> cmsis.h:75</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_a9994061c95a57834424015598f636d7f"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#a9994061c95a57834424015598f636d7f">CMSIS::Thread::~Thread</a></div><div class="ttdeci">~Thread()</div><div class="ttdoc">Delete thread. </div><div class="ttdef"><b>Definition:</b> cmsis.h:711</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_message_queue_html"><div class="ttname"><a href="class_c_m_s_i_s_1_1_message_queue.html">CMSIS::MessageQueue</a></div><div class="ttdoc">Wrapper for CMSIS Message Queue. </div><div class="ttdef"><b>Definition:</b> cmsis.h:893</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_a0cb7c341b1261e8dc3b6814597f4dc72"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#a0cb7c341b1261e8dc3b6814597f4dc72">CMSIS::Timer::getId</a></div><div class="ttdeci">osTimerId getId()</div><div class="ttdoc">Get timer ID. </div><div class="ttdef"><b>Definition:</b> cmsis.h:167</div></div>
<div class="ttc" id="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t_html_a9001cc75aeefd00548934c2e8ee73bdb"><div class="ttname"><a href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a9001cc75aeefd00548934c2e8ee73bdb">CMSIS::Timer::osTimerControlBlock_t::timer</a></div><div class="ttdeci">const osTimerDef_t * timer</div><div class="ttdef"><b>Definition:</b> cmsis.h:71</div></div>
<div class="ttc" id="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t_html_a3bbc4b2c70d1a6fd1c1e595b65c596e0"><div class="ttname"><a href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a3bbc4b2c70d1a6fd1c1e595b65c596e0">CMSIS::Timer::osTimerControlBlock_t::next</a></div><div class="ttdeci">struct os_timer_cb_ * next</div><div class="ttdef"><b>Definition:</b> cmsis.h:64</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_message_queue_html_abf5c03426f999426129b0181a33f1b60"><div class="ttname"><a href="class_c_m_s_i_s_1_1_message_queue.html#abf5c03426f999426129b0181a33f1b60">CMSIS::MessageQueue::putISR</a></div><div class="ttdeci">osStatus putISR(T info)</div><div class="ttdoc">Put message to queue. </div><div class="ttdef"><b>Definition:</b> cmsis.h:936</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mutex_html_a6706589400823ef52b20dc266fc1b62f"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mutex.html#a6706589400823ef52b20dc266fc1b62f">CMSIS::Mutex::getID</a></div><div class="ttdeci">osMutexId getID()</div><div class="ttdoc">Get mutex ID. </div><div class="ttdef"><b>Definition:</b> cmsis.h:348</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_semaphore_html_a38527008cc03b62cc34573a3442336b4"><div class="ttname"><a href="class_c_m_s_i_s_1_1_semaphore.html#a38527008cc03b62cc34573a3442336b4">CMSIS::Semaphore::Semaphore</a></div><div class="ttdeci">Semaphore(int32_t count)</div><div class="ttdoc">Create semaphore. </div><div class="ttdef"><b>Definition:</b> cmsis.h:367</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mutex_html"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mutex.html">CMSIS::Mutex</a></div><div class="ttdoc">Wrapper for CMSIS mutex. </div><div class="ttdef"><b>Definition:</b> cmsis.h:268</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_aab49c70b18997f3f15efbb23e5e1e20f"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#aab49c70b18997f3f15efbb23e5e1e20f">CMSIS::Thread::signalWait</a></div><div class="ttdeci">static osEvent signalWait(int32_t signals, uint32_t millisec=osWaitForever)</div><div class="ttdoc">Wait for one or more Signal Flags to become signaled for the current thread. </div><div class="ttdef"><b>Definition:</b> cmsis.h:643</div></div>
<div class="ttc" id="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t_html_aa6c426196c10f2a72f7c117a3875c8d4"><div class="ttname"><a href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#aa6c426196c10f2a72f7c117a3875c8d4">CMSIS::Timer::osTimerControlBlock_t::state</a></div><div class="ttdeci">uint8_t state</div><div class="ttdef"><b>Definition:</b> cmsis.h:65</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_class_html_aaf68b82240fcca07a1a089d0dbe55993"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread_class.html#aaf68b82240fcca07a1a089d0dbe55993">CMSIS::ThreadClass::task</a></div><div class="ttdeci">virtual void task()=0</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_aa69da4e44350866b31f22b9946092d73"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#aa69da4e44350866b31f22b9946092d73">CMSIS::Timer::start</a></div><div class="ttdeci">void start(int millisec)</div><div class="ttdoc">Start or restart timer. </div><div class="ttdef"><b>Definition:</b> cmsis.h:151</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_class_html_a831e59cb3fd28c669bf1609ff599a320"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread_class.html#a831e59cb3fd28c669bf1609ff599a320">CMSIS::ThreadClass::~ThreadClass</a></div><div class="ttdeci">virtual ~ThreadClass()</div><div class="ttdef"><b>Definition:</b> cmsis.h:813</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_pool_html_a17a4bc41b4dc754355ca8375cb443911"><div class="ttname"><a href="class_c_m_s_i_s_1_1_pool.html#a17a4bc41b4dc754355ca8375cb443911">CMSIS::Pool::create</a></div><div class="ttdeci">void create()</div><div class="ttdoc">Create pool. </div><div class="ttdef"><b>Definition:</b> cmsis.h:468</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mail_queue_html_aadd4193772c79b11e90b663de912950e"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mail_queue.html#aadd4193772c79b11e90b663de912950e">CMSIS::MailQueue::create</a></div><div class="ttdeci">void create()</div><div class="ttdoc">Create mail queue. </div><div class="ttdef"><b>Definition:</b> cmsis.h:1091</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_ab1ff38ed2a8339974d60f1b60387f1bb"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#ab1ff38ed2a8339974d60f1b60387f1bb">CMSIS::Timer::create</a></div><div class="ttdeci">bool create(void *argument=nullptr, os_timer_type timerType=osTimerPeriodic)</div><div class="ttdoc">Recreate the associated CMSIS timer with different characteristics. </div><div class="ttdef"><b>Definition:</b> cmsis.h:125</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_pool_html_a9ab6958cfff50bd5eedd684153f56907"><div class="ttname"><a href="class_c_m_s_i_s_1_1_pool.html#a9ab6958cfff50bd5eedd684153f56907">CMSIS::Pool::free</a></div><div class="ttdeci">void free(T *buffer)</div><div class="ttdoc">Return a memory block to a memory pool. </div><div class="ttdef"><b>Definition:</b> cmsis.h:505</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_a01e5128acafdcfbb70b19847ed5a0d8a"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#a01e5128acafdcfbb70b19847ed5a0d8a">CMSIS::Timer::Timer</a></div><div class="ttdeci">Timer(Callback callback, os_timer_type timerType)</div><div class="ttdoc">Constructor - Create timer of given type. </div><div class="ttdef"><b>Definition:</b> cmsis.h:96</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mutex_html_abf583aabc8a93f25559bc20d913df661"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mutex.html#abf583aabc8a93f25559bc20d913df661">CMSIS::Mutex::unlock</a></div><div class="ttdeci">osStatus unlock()</div><div class="ttdoc">Unlock mutex See release() </div><div class="ttdef"><b>Definition:</b> cmsis.h:340</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_pool_html_a92709e542909617d638696c6a1f5fabe"><div class="ttname"><a href="class_c_m_s_i_s_1_1_pool.html#a92709e542909617d638696c6a1f5fabe">CMSIS::Pool::~Pool</a></div><div class="ttdeci">~Pool()</div><div class="ttdef"><b>Definition:</b> cmsis.h:462</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_a6e5f78e844c5e79e9cf1080df673391f"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#a6e5f78e844c5e79e9cf1080df673391f">CMSIS::Thread::Thread</a></div><div class="ttdeci">Thread(osThreadId thread_id)</div><div class="ttdoc">Create thread as a wrapper for an existing thread. </div><div class="ttdef"><b>Definition:</b> cmsis.h:694</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_semaphore_html_a1a394802e0f76611698ecd3b253f374c"><div class="ttname"><a href="class_c_m_s_i_s_1_1_semaphore.html#a1a394802e0f76611698ecd3b253f374c">CMSIS::Semaphore::~Semaphore</a></div><div class="ttdeci">~Semaphore()</div><div class="ttdoc">Delete semaphore. </div><div class="ttdef"><b>Definition:</b> cmsis.h:374</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mutex_html_aa4c1ad556dbbd9ce354323f55f330991"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mutex.html#aa4c1ad556dbbd9ce354323f55f330991">CMSIS::Mutex::Mutex</a></div><div class="ttdeci">Mutex()</div><div class="ttdoc">Create mutex. </div><div class="ttdef"><b>Definition:</b> cmsis.h:278</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_a1ae6910e486479644e09a87fd9192807"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#a1ae6910e486479644e09a87fd9192807">CMSIS::Timer::os_timer_cb</a></div><div class="ttdeci">osTimerControlBlock_t os_timer_cb</div><div class="ttdef"><b>Definition:</b> cmsis.h:74</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mutex_html_a209ac634b372a1201bcbd251fdb860bb"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mutex.html#a209ac634b372a1201bcbd251fdb860bb">CMSIS::Mutex::tryLock</a></div><div class="ttdeci">osStatus tryLock()</div><div class="ttdoc">Try to obtain mutex with immediate fail if unsuccessful. </div><div class="ttdef"><b>Definition:</b> cmsis.h:333</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_thread_html_a48bcac974975bc098e6cb669f0007a5e"><div class="ttname"><a href="class_c_m_s_i_s_1_1_thread.html#a48bcac974975bc098e6cb669f0007a5e">CMSIS::Thread::yield</a></div><div class="ttdeci">static osStatus yield()</div><div class="ttdoc">Pass control to the next thread that is in state READY. </div><div class="ttdef"><b>Definition:</b> cmsis.h:605</div></div>
<div class="ttc" id="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t_html_a2903668d80e9b4d12e3d907ab1a82167"><div class="ttname"><a href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#a2903668d80e9b4d12e3d907ab1a82167">CMSIS::Timer::osTimerControlBlock_t::reserved</a></div><div class="ttdeci">uint16_t reserved</div><div class="ttdef"><b>Definition:</b> cmsis.h:67</div></div>
<div class="ttc" id="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t_html"><div class="ttname"><a href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html">CMSIS::Timer::osTimerControlBlock_t</a></div><div class="ttdoc">Based on os_timer_cb in rt_CMSIS.c Timer Control Block. </div><div class="ttdef"><b>Definition:</b> cmsis.h:63</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html_a96b762bb31988a8b4fa4f5133e4f8b55"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html#a96b762bb31988a8b4fa4f5133e4f8b55">CMSIS::Timer::Timer</a></div><div class="ttdeci">Timer(Callback callback, void *argument=nullptr)</div><div class="ttdoc">Constructor - Create Periodic timer. </div><div class="ttdef"><b>Definition:</b> cmsis.h:105</div></div>
<div class="ttc" id="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t_html_ab23ebce72952d06fcf42c50cb4642553"><div class="ttname"><a href="struct_c_m_s_i_s_1_1_timer_1_1os_timer_control_block__t.html#ab23ebce72952d06fcf42c50cb4642553">CMSIS::Timer::osTimerControlBlock_t::tcnt</a></div><div class="ttdeci">uint32_t tcnt</div><div class="ttdef"><b>Definition:</b> cmsis.h:68</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_pool_html_af66f6dfb20f654686fa57022a410a728"><div class="ttname"><a href="class_c_m_s_i_s_1_1_pool.html#af66f6dfb20f654686fa57022a410a728">CMSIS::Pool::getId</a></div><div class="ttdeci">osPoolId getId()</div><div class="ttdoc">Get pool ID. </div><div class="ttdef"><b>Definition:</b> cmsis.h:514</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mail_queue_html_a4ad782d61fe981dfcb70579acb0fd383"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mail_queue.html#a4ad782d61fe981dfcb70579acb0fd383">CMSIS::MailQueue::getISR</a></div><div class="ttdeci">osEvent getISR()</div><div class="ttdoc">Get a mail item from the mail queue. </div><div class="ttdef"><b>Definition:</b> cmsis.h:1188</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_semaphore_html_afee15019c943625da9feb26066db9cbb"><div class="ttname"><a href="class_c_m_s_i_s_1_1_semaphore.html#afee15019c943625da9feb26066db9cbb">CMSIS::Semaphore::release</a></div><div class="ttdeci">void release()</div><div class="ttdoc">Release semaphore. </div><div class="ttdef"><b>Definition:</b> cmsis.h:392</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mail_queue_html_af7575e2e38147d39a6c0f854281c5a61"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mail_queue.html#af7575e2e38147d39a6c0f854281c5a61">CMSIS::MailQueue::getId</a></div><div class="ttdeci">osMailQId getId()</div><div class="ttdoc">Get mail queue ID. </div><div class="ttdef"><b>Definition:</b> cmsis.h:1209</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_class_html"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer_class.html">CMSIS::TimerClass</a></div><div class="ttdoc">Wrapper for CMSIS Timer. </div><div class="ttdef"><b>Definition:</b> cmsis.h:222</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_timer_html"><div class="ttname"><a href="class_c_m_s_i_s_1_1_timer.html">CMSIS::Timer</a></div><div class="ttdoc">Wrapper for CMSIS Timer. </div><div class="ttdef"><b>Definition:</b> cmsis.h:56</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_message_queue_html_a93c5eaa5d5294eeafaaab86cd496b644"><div class="ttname"><a href="class_c_m_s_i_s_1_1_message_queue.html#a93c5eaa5d5294eeafaaab86cd496b644">CMSIS::MessageQueue::put</a></div><div class="ttdeci">osStatus put(T info, uint32_t millisec=osWaitForever)</div><div class="ttdoc">Put message to queue with timeout. </div><div class="ttdef"><b>Definition:</b> cmsis.h:950</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_pool_html"><div class="ttname"><a href="class_c_m_s_i_s_1_1_pool.html">CMSIS::Pool</a></div><div class="ttdoc">Wrapper for CMSIS Memory Allocation Pool. </div><div class="ttdef"><b>Definition:</b> cmsis.h:453</div></div>
<div class="ttc" id="class_c_m_s_i_s_1_1_mutex_html_a14664c6f781ff30d23b4fec5519ab301"><div class="ttname"><a href="class_c_m_s_i_s_1_1_mutex.html#a14664c6f781ff30d23b4fec5519ab301">CMSIS::Mutex::wait</a></div><div class="ttdeci">osStatus wait(uint32_t millisec=osWaitForever)</div><div class="ttdoc">Obtain mutex. </div><div class="ttdef"><b>Definition:</b> cmsis.h:304</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 21 2017 07:45:21 for USBDM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
